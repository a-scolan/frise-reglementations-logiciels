<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frise Chronologique R√©glementaire - Prestataires Logiciels</title>
<style>
  /* --- RESET ET POLICES --- */
  * { box-sizing: border-box; }
  body {
    background-color: #e8eceb;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #333;
    margin: 0;
    padding: 20px;
  }

  h1 { text-align: center; color: #2c3e50; margin-bottom: 5px; }
  p.subtitle { text-align: center; font-style: italic; margin-bottom: 20px; color: #7f8c8d; }

  /* --- COULEURS CIBLES (Categories) --- */
  /* Universel : Tout logiciel, ESN, Dev */
 .theme-universal { --main-color: #34495e; --bg-light: #eaeded; } 
  /* B2B & Cloud : SaaS, ERP, H√©bergement */
 .theme-b2b { --main-color: #2980b9; --bg-light: #d6eaf8; }
  /* B2C & Plateformes : Apps, Marketplaces, E-commerce */
 .theme-b2c { --main-color: #8e44ad; --bg-light: #ebdef0; }
  /* Industrie & IoT : Logiciels embarqu√©s, Hardware */
 .theme-iot { --main-color: #27ae60; --bg-light: #d5f5e3; }
  /* Secteurs R√©gul√©s : Banque, Sant√©, Public */
 .theme-regulated { --main-color: #c0392b; --bg-light: #fadbd8; }
  /* ESN : Entreprises Services Num√©rique */
 .theme-esn { --main-color: #e67e22; --bg-light: #fdebd0; }

  /* --- L√âGENDE / PANNEAU DE FILTRAGE FLOTTANT --- */
 .legend-container {
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1001;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 10px;
    padding: 12px 20px;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    border-bottom: 2px solid #ecf0f1;
    transition: all 0.3s ease;
    overflow: visible;
  }

 .legend-title {
    font-weight: bold;
    margin: 0 15px 0 0;
    color: #2c3e50;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 1px;
    white-space: nowrap;
    cursor: default;
  }
  
 .legend-toggle-btn {
    display: none;
  }

 .legend-items-wrapper {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
    justify-content: center;
  }

 .legend-item {
    display: flex;
    align-items: center;
    font-size: 0.8rem;
    font-weight: 600;
    padding: 8px 14px;
    border-radius: 20px;
    border: 2px solid;
    transition: all 0.2s;
    cursor: pointer;
    user-select: none;
  }
  
 .legend-item:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
  
 .legend-item.active {
    opacity: 1;
  }
  
 .legend-item.inactive {
    opacity: 0.35;
    background: #f8f9fa;
    filter: grayscale(50%);
  }

 .dot {
    height: 12px;
    width: 12px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 8px;
    flex-shrink: 0; /* Emp√™che l'√©crasement du cercle */
  }

  /* Application des couleurs l√©gende */
 .leg-universal { background-color: #eaeded; color: #34495e; border-color: #34495e; }
 .leg-universal.dot { background-color: #34495e; }
 .leg-universal.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-b2b { background-color: #d6eaf8; color: #2980b9; border-color: #2980b9; }
 .leg-b2b.dot { background-color: #2980b9; }
 .leg-b2b.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-b2c { background-color: #ebdef0; color: #8e44ad; border-color: #8e44ad; }
 .leg-b2c.dot { background-color: #8e44ad; }
 .leg-b2c.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-iot { background-color: #d5f5e3; color: #27ae60; border-color: #27ae60; }
 .leg-iot.dot { background-color: #27ae60; }
 .leg-iot.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-regulated { background-color: #fadbd8; color: #c0392b; border-color: #c0392b; }
 .leg-regulated.dot { background-color: #c0392b; }
 .leg-regulated.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-esn { background-color: #fdebd0; color: #e67e22; border-color: #e67e22; }
 .leg-esn.dot { background-color: #e67e22; }
 .leg-esn.inactive { border-color: #bdc3c7; color: #7f8c8d; }
 
 /* Compteur sur les items de l√©gende */
 .legend-count {
    margin-left: 6px;
    font-size: 0.75rem;
    padding: 2px 6px;
    border-radius: 10px;
    background: rgba(0,0,0,0.15);
    font-weight: bold;
  }

  /* --- TIMELINE --- */
 .timeline {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
    margin-top: 20px;
  }

  /* Ligne verticale */
 .timeline::after {
    content: '';
    position: absolute;
    width: 4px;
    background-color: #bdc3c7;
    top: 0;
    bottom: 0;
    left: 50%;
    margin-left: -2px;
    border-radius: 2px;
  }

  /* Conteneur */
    .container {
      padding: 10px 40px;
      position: relative;
      background-color: inherit;
      width: 50%;
    }

    .container.left {
      margin-top: -120px;
    }

    .container.right {
      margin-top: -120px;
    }

    .container:first-child,
    .container:not(.hidden):first-of-type {
      margin-top: 0 !important;
    }  /* Cercles sur la ligne */
 .container::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    right: -8px;
    background-color: white;
    border: 3px solid #bdc3c7;
    top: 24px; /* Ajust√© pour aligner avec le header */
    border-radius: 50%;
    z-index: 1;
  }

  /* Gauche / Droite */
 .left { left: 0; }
 .right { left: 50%; }
 .left::before {
    content: " ";
    height: 0;
    position: absolute;
    top: 26px;
    width: 0;
    z-index: 1;
    right: 30px;
    border: medium solid white;
    border-width: 10px 0 10px 10px;
    border-color: transparent transparent transparent white;
  }
 .right::before {
    content: " ";
    height: 0;
    position: absolute;
    top: 26px;
    width: 0;
    z-index: 1;
    left: 30px;
    border: medium solid white;
    border-width: 10px 10px 10px 0;
    border-color: transparent white transparent transparent;
  }
 .right::after { left: -8px; }

  /* Carte de contenu */
 .content {
    padding: 20px 25px 10px 25px;
    background-color: white;
    position: relative;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    border-left: 6px solid #ccc; /* Couleur par d√©faut */
  }

  /* --- STYLES INTERNES CARTE --- */
 .header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }

 .date-badge {
    background-color: #555;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: bold;
  }

 .origin-badge {
    font-size: 0.75rem;
    padding: 2px 6px;
    border-radius: 4px;
    text-transform: uppercase;
    font-weight: 800;
    border: 1px solid #ddd;
  }
 .origin-eu { color: #003399; background-color: #e6f0ff; border-color: #003399; } /* Bleu Europe */
 .origin-fr { color: #002395; background-color: #f0f0f0; border-color: #ed2939; } /* Bleu/Rouge France */

  h2 { margin: 0 0 5px 0; font-size: 1.1rem; color: #333; }
  
 .target-tag {
    display: inline-block;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    margin-bottom: 8px;
    padding: 2px 0;
    color: var(--main-color, #555);
  }

  p { margin: 5px 0 0; line-height: 1.4; font-size: 0.9rem; color: #555; }

  /* Liens r√©glementaires */
 .reg-link {
    display: inline-block;
    margin-top: 8px;
    font-size: 0.8rem;
    color: #3498db;
    text-decoration: none;
    font-weight: 600;
    transition: color 0.2s;
  }
 .reg-link:hover {
    color: #2980b9;
    text-decoration: underline;
  }

  /* Marqueur date actuelle */
 .current-date-marker {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 30px;
    background-color: #e74c3c;
    color: white;
    text-align: center;
    line-height: 30px;
    font-weight: bold;
    font-size: 0.8rem;
    border-radius: 4px;
    z-index: 10;
    box-shadow: 0 2px 10px rgba(231, 76, 60, 0.4);
  }
 .current-date-marker::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid #e74c3c;
  }
 .current-date-marker.bottom-marker {
    top: auto !important;
    bottom: 20px;
  }
 .current-date-marker.bottom-marker::after {
    bottom: auto;
    top: -8px;
    border-top: none;
    border-bottom: 8px solid #e74c3c;
  }

  /* Bouton retour √† aujourd'hui */
 .back-to-today {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #e74c3c;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 50px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.85rem;
    z-index: 1000;
    box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }
 .back-to-today:hover {
    background: #c0392b;
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
  }
 .back-to-today:active {
    transform: translateY(0);
  }

  /* --- SOMMAIRE FLOTTANT --- */
 .toc-container {
    position: sticky;
    top: 120px;
    right: 20px;
    width: 280px;
    max-height: calc(100vh - 200px);
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    z-index: 998;
    transition: all 0.3s ease;
    overflow: hidden;
    float: right;
    margin-top: 20px;
    margin-right: 20px;
    margin-left: 20px;
  }
 .toc-container.collapsed {
    width: auto;
    max-height: 50px;
    box-shadow: -4px 4px 12px rgba(0,0,0,0.2);
  }
 .toc-container.collapsed .toc-content {
    display: none;
  }
 .toc-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 18px;
    background: #2c3e50;
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
  }
 .toc-header:hover {
    background: #34495e;
  }
 .toc-container.collapsed .toc-header {
    border-radius: 12px 0 0 12px;
  }
 .toc-title {
    font-weight: bold;
    color: white;
    font-size: 0.9rem;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 8px;
  }
 .toc-toggle-icon {
    font-size: 1rem;
    transition: transform 0.3s ease;
  }
 .toc-container.collapsed .toc-toggle-icon {
    transform: rotate(180deg);
  }
 .toc-content {
    padding: 15px 10px;
    max-height: calc(100vh - 260px);
    overflow-y: auto;
    background: white;
  }
 .toc-item {
    display: block;
    padding: 8px 15px;
    margin: 3px 0;
    font-size: 0.8rem;
    color: #34495e;
    text-decoration: none;
    border-radius: 6px;
    border-left: 3px solid transparent;
    transition: all 0.2s;
    cursor: pointer;
  }
 .toc-item:hover {
    background: #ecf0f1;
    border-left-color: #3498db;
    transform: translateX(3px);
  }
 .toc-item-date {
    font-weight: bold;
    color: #7f8c8d;
    font-size: 0.7rem;
    display: block;
    margin-bottom: 2px;
  }
 .toc-item-title {
    display: block;
    font-weight: 600;
  }
 .toc-item.active {
    background: #d6eaf8;
    border-left-color: #2980b9;
  }

  /* Animation de masquage des conteneurs filtr√©s */
 .container.hidden {
    display: none;
  }

  /* --- BOUTON MES OBLIGATIONS (CENTR√â) --- */
    .obligations-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      display: block;
      margin: 25px auto 15px auto;
      z-index: 10;
    }

    .obligations-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .obligations-btn:active {
      transform: translateY(0);
    }

  /* --- POPUP MODALE OBLIGATIONS --- */
 .obligations-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    z-index: 2000;
    animation: fadeIn 0.3s ease;
  }
 .obligations-modal.show {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
  }
 @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
 .obligations-modal-content {
    background: white;
    border-radius: 16px;
    max-width: 700px;
    width: 100%;
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
    position: relative;
  }
 @keyframes slideUp {
    from { transform: translateY(50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
 .obligations-modal-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px 25px;
    border-radius: 16px 16px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
 .obligations-modal-header h3 {
    margin: 0;
    font-size: 1.3rem;
    font-weight: 700;
  }
 .obligations-modal-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    font-size: 1.8rem;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    font-weight: 300;
    line-height: 1;
    padding: 0;
    font-family: Arial, sans-serif;
  }
 .obligations-modal-close:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: rotate(90deg);
  }
 .obligations-modal-body {
    padding: 25px;
  }
 .obligations-modal-body h4 {
    margin: 0 0 15px 0;
    color: #2c3e50;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 8px;
  }
 .obligations-modal-body ul {
    margin-bottom: 12px;
    padding-left: 20px;
    line-height: 1.8;
  }
 .obligations-modal-body li {
    color: #555;
    font-size: 0.9rem;
  }
 .obligations-modal-body li strong {
    color: #2c3e50;
    font-weight: 600;
  }
 .obligations-highlight {
    background: #fff3cd;
    border-left: 4px solid #ffc107;
    padding: 12px 15px;
    margin: 15px 0;
    border-radius: 4px;
    font-size: 0.85rem;
    color: #856404;
  }
 .obligations-highlight strong {
    color: #533f03;
  }

  /* --- APPLICATION DES TH√àMES AUX CARTES --- */
 .card-universal { border-left-color: #34495e; }
 .card-universal.date-badge { background-color: #34495e; }
 .card-universal.target-tag { color: #34495e; }

 .card-b2b { border-left-color: #2980b9; }
 .card-b2b.date-badge { background-color: #2980b9; }
 .card-b2b.target-tag { color: #2980b9; }

 .card-b2c { border-left-color: #8e44ad; }
 .card-b2c.date-badge { background-color: #8e44ad; }
 .card-b2c.target-tag { color: #8e44ad; }

 .card-iot { border-left-color: #27ae60; }
 .card-iot.date-badge { background-color: #27ae60; }
 .card-iot.target-tag { color: #27ae60; }

 .card-regulated { border-left-color: #c0392b; }
 .card-regulated.date-badge { background-color: #c0392b; }
 .card-regulated.target-tag { color: #c0392b; }

  /* ESN-specific info tag */
 .esn-info {
    display: block;
    margin-top: 8px;
    padding: 4px 10px;
    background: #fdebd0;
    color: #e67e22;
    border: 1px solid #e67e22;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    transition: opacity 0.3s ease;
    width: fit-content;
  }
 .esn-info.hidden {
    display: none;
  }

  /* Footer */
 .footer {
    text-align: center;
    padding: 40px 20px;
    margin-top: 60px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
  }
 .footer p {
    margin: 5px 0;
    color: #7f8c8d;
    font-size: 0.9rem;
  }
 .footer strong {
    color: #2c3e50;
  }

  /* --- RESPONSIVE --- */
  @media screen and (max-width: 768px) {
   .timeline::after { left: 31px; }
   .container { 
     width: 100%; 
     padding-left: 70px; 
     padding-right: 25px;
     padding-top: 15px;
     padding-bottom: 15px;
     margin-top: 0 !important;
   }
   .container::before { left: 60px; border: medium solid white; border-width: 10px 10px 10px 0; border-color: transparent white transparent transparent; }
   .left::after,.right::after { left: 21px; }
   .right { left: 0%; }
   .legend-container { 
     flex-direction: column; 
     align-items: stretch;
     padding: 0;
     gap: 0;
     max-height: 50px;
     overflow: hidden;
     width: 100%;
     left: 0;
     right: 0;
   }
   .legend-container.expanded {
     max-height: 500px;
     overflow-y: auto;
   }
   .legend-toggle-btn {
     display: block;
     width: 100%;
     padding: 12px;
     background: #2c3e50;
     color: white;
     border: none;
     font-weight: bold;
     font-size: 0.85rem;
     cursor: pointer;
     text-align: center;
   }
   .legend-toggle-btn:active {
     background: #34495e;
   }
   .legend-title {
     display: none;
   }
   .legend-items-wrapper {
     padding: 8px 10px;
     display: none;
     flex-direction: column;
     gap: 6px;
     width: 100%;
   }
   .legend-container.expanded .legend-items-wrapper {
     display: flex;
   }
   .toc-container {
     display: block !important;
   }
   .legend-item {
     font-size: 0.7rem;
     padding: 6px 8px;
     width: 100%;
     justify-content: space-between;
     flex-wrap: nowrap;
   }
   .legend-item .dot {
     margin-right: 6px;
     flex-shrink: 0;
   }
   .legend-count {
     margin-left: auto;
     flex-shrink: 0;
   }
   .timeline { margin-top: 80px; }
   .current-date-marker { 
     width: 85px; 
     font-size: 0.65rem;
     left: -11px;
     transform: none;
   }
   .current-date-marker::after {
     left: 35px;
     transform: none;
   }
   .current-date-marker.bottom-marker {
     left: -11px;
     transform: none;
     width: 85px;
   }
   .current-date-marker.bottom-marker::after {
     left: 34px;
     transform: none;
   }
   .back-to-today {
     position: fixed;
     bottom: 80px;
     right: 15px;
     left: 15px;
     padding: 10px 14px;
     font-size: 0.8rem;
     justify-content: center;
     transition: bottom 0.3s ease;
     z-index: 999;
   }
   .timeline { margin-top: 200px; }
   .toc-container {
     position: fixed;
     width: calc(100% - 30px);
     right: 15px;
     left: 15px;
     top: auto;
     bottom: 20px;
     max-height: 50px;
     border-radius: 12px;
     box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
     transition: max-height 0.3s ease, bottom 0.3s ease;
     z-index: 998;
     overflow: hidden;
     float: none;
     margin: 0;
   }
   .toc-container:not(.collapsed) {
     max-height: 50vh;
   }
   .toc-container.collapsed {
     max-height: 50px;
   }
   .toc-container.collapsed .toc-header {
     border-radius: 12px;
   }
   .toc-toggle-icon {
     transform: rotate(180deg);
   }
   .toc-container.collapsed .toc-toggle-icon {
     transform: rotate(0deg);
   }
   body.toc-open .back-to-today {
     bottom: calc(50vh + 30px);
   }
   body.toc-open .toc-container {
     bottom: 20px;
   }
   
   /* Panneau de filtrage en mobile */
   .filter-panel {
     top: 10px;
     right: 10px;
     left: 10px;
     max-width: none;
     padding: 15px;
   }
   .filter-toggle {
     top: 10px;
     right: 10px;
     padding: 10px 14px;
     font-size: 0.85rem;
   }
   .filter-btn {
     font-size: 0.8rem;
     padding: 8px 12px;
   }
   .filter-panel-title {
     font-size: 0.9rem;
   }
  }
</style>
</head>
<body>

<h1>√âch√©ances R√©glementaires : Logiciels & SaaS</h1>
<p class="subtitle">Vue synth√©tique par type d'acteur concern√© (2016 - 2030+) | <strong>Version Q4 2025</strong></p>

<!-- Panneau de filtrage flottant (ancienne l√©gende transform√©e) -->
<div class="legend-container" id="legendContainer">
  <button class="legend-toggle-btn" id="legendToggle">üîç Filtrer par cat√©gorie</button>
  <div class="legend-title">Qui est concern√© ?</div>
  <div class="legend-items-wrapper">
    <div class="legend-item leg-universal active" data-category="universal">
      <span class="dot"></span>Universel (Tout Logiciel / Tout Site)
      <span class="legend-count" id="count-universal">0</span>
    </div>
    <div class="legend-item leg-b2b active" data-category="b2b">
      <span class="dot"></span>SaaS B2B, Cloud & Gestion
      <span class="legend-count" id="count-b2b">0</span>
    </div>
    <div class="legend-item leg-b2c active" data-category="b2c">
      <span class="dot"></span>Plateformes, Apps B2C & Marketplaces
      <span class="legend-count" id="count-b2c">0</span>
    </div>
    <div class="legend-item leg-iot active" data-category="iot">
      <span class="dot"></span>IoT, Industrie & Mat√©riel
      <span class="legend-count" id="count-iot">0</span>
    </div>
    <div class="legend-item leg-regulated active" data-category="regulated">
      <span class="dot"></span>Secteurs R√©gul√©s (Finance, Sant√©, Public)
      <span class="legend-count" id="count-regulated">0</span>
    </div>
    <div class="legend-item leg-esn inactive" data-category="esn">
      <span class="dot"></span>ESN & Prestataires IT
      <span class="legend-count" id="count-esn">0</span>
    </div>
  </div>
</div>

<!-- Bouton retour √† aujourd'hui -->
<button class="back-to-today" id="backToToday">
  üìÖ Aujourd'hui
</button>

<!-- Sommaire flottant -->
<div class="toc-container collapsed" id="tocContainer">
  <div class="toc-header" id="tocHeader">
    <h3 class="toc-title">
      üìã Sommaire
      <span class="toc-toggle-icon">‚óÄ</span>
    </h3>
  </div>
  <div class="toc-content" id="tocContent">
    <!-- G√©n√©r√© dynamiquement par JavaScript -->
  </div>
</div>

<div class="timeline">

  <div class="container right">
    <div class="content card-universal card-esn">
      <div class="header-row">
        <span class="date-badge">25 Mai 2018</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>RGPD (R√®glement G√©n√©ral sur la Protection des Donn√©es)</h2>
      <span class="target-tag">Cible : Tout Logiciel / Tout Traitement de Donn√©es<span class="esn-info">ESN : DPO obligatoire si traitement grande √©chelle</span></span>
      <p>Protection des donn√©es personnelles : privacy by design et by default, droit √† l'oubli, portabilit√© des donn√©es. Sanctions jusqu'√† 20M‚Ç¨ ou 4% du CA mondial annuel. 6 bases l√©gales exclusives : consentement explicite (opt-in r√©vocable), ex√©cution contrat, obligation l√©gale, sauvegarde int√©r√™ts vitaux, mission int√©r√™t public, int√©r√™t l√©gitime (balanc√© avec droits utilisateur). DPO obligatoire si traitement grande √©chelle ou donn√©es sensibles. Registre traitements obligatoire. Notification violations CNIL sous 72h. AIPD obligatoire si risque √©lev√©.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2016/679/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2016/679</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-rgpd')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal RGPD -->
  <div class="obligations-modal" id="modal-rgpd">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - RGPD</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-rgpd')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Obligations Imm√©diates</h4>
        <ul>
          <li><strong>Identifier la base l√©gale</strong> pour chaque traitement de donn√©es (consentement, contrat, int√©r√™t l√©gitime, obligation l√©gale...)</li>
          <li><strong>Tenir un registre des traitements</strong> d√©taillant : finalit√©s, cat√©gories de donn√©es, destinataires, dur√©es de conservation, mesures de s√©curit√©</li>
          <li><strong>Mettre en ≈ìuvre la privacy by design</strong> : minimisation des donn√©es, pseudonymisation, chiffrement</li>
          <li><strong>Informer les utilisateurs</strong> : politique de confidentialit√© claire, accessible, mentionnant tous les droits (acc√®s, rectification, effacement, portabilit√©, opposition)</li>
          <li><strong>S√©curiser les donn√©es</strong> : contr√¥les d'acc√®s, chiffrement en transit et au repos, sauvegardes, journalisation</li>
          <li><strong>Nommer un DPO</strong> (D√©l√©gu√© √† la Protection des Donn√©es) si traitement √† grande √©chelle, donn√©es sensibles ou organisme public</li>
          <li><strong>Notifier la CNIL sous 72h</strong> en cas de violation de donn√©es (avec description, impact, mesures prises)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Jusqu'√† 20M‚Ç¨ ou 4% du CA mondial annuel selon gravit√©. La CNIL peut aussi ordonner la suspension des traitements.
        </div>
        <h4>üìä Si Traitement √† Risque √âlev√©</h4>
        <ul>
          <li><strong>R√©aliser une AIPD</strong> (Analyse d'Impact sur la Protection des Donn√©es) document√©e</li>
          <li><strong>Consulter la CNIL</strong> avant mise en ≈ìuvre si risque r√©siduel √©lev√© malgr√© mesures</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal card-esn">
      <div class="header-row">
        <span class="date-badge">25 Mai 2018</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>ePrivacy (Directive Cookie)</h2>
      <span class="target-tag">Cible : Tous Sites Web & Apps<span class="esn-info">ESN : Si site web/app propre ou client</span></span>
      <p>Consentement explicite requis avant tout cookie non essentiel (marketing, analytics, publicit√©). Bandeau cookie obligatoire avec refus aussi facile qu'acceptation (m√™me nombre de clics). Interdiction des "cookie walls" abusifs (bloquer l'acc√®s sans consentement). En France, appliqu√© strictement par la CNIL depuis 2020 (lignes directrices). Dur√©e conservation consentement : 13 mois max. Preuve consentement obligatoire (logs horodat√©s).</p>
      <a href="https://eur-lex.europa.eu/legal-content/FR/TXT/?uri=CELEX%3A32002L0058" target="_blank" class="reg-link">üìÑ Directive 2002/58/CE</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-eprivacy')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal ePrivacy -->
  <div class="obligations-modal" id="modal-eprivacy">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - ePrivacy / Cookies</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-eprivacy')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Obligations sur Tous Sites Web/Apps</h4>
        <ul>
          <li><strong>Afficher un bandeau cookie</strong> avant tout d√©p√¥t de cookie non essentiel</li>
          <li><strong>Permettre le refus facile</strong> : bouton "Tout refuser" aussi visible que "Tout accepter", m√™me nombre de clics</li>
          <li><strong>Ne d√©poser QUE les cookies essentiels</strong> avant consentement (authentification, panier, s√©curit√©, pr√©f√©rences d'affichage basiques)</li>
          <li><strong>Lister tous les cookies</strong> avec finalit√©, dur√©e, tiers concern√©s dans la politique cookies</li>
          <li><strong>Conserver la preuve du consentement</strong> : logs horodat√©s avec choix utilisateur, version bandeau, IP (pseudonymis√©e)</li>
          <li><strong>Limiter la dur√©e</strong> : consentement valable 13 mois maximum, puis redemander</li>
          <li><strong>Respecter le choix</strong> : ne pas recharger cookies refus√©s √† chaque visite (pas de cookie wall abusif)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Amendes CNIL jusqu'√† 20M‚Ç¨ ou 4% CA (cumul possible avec RGPD). Nombreuses condamnations en 2023-2024.
        </div>
        <h4>üç™ Cookies Exempt√©s (Pas de Consentement)</h4>
        <ul>
          <li>Authentification utilisateur (session)</li>
          <li>Panier e-commerce</li>
          <li>Pr√©f√©rences interface (langue, accessibilit√©)</li>
          <li>√âquilibrage charge serveurs</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container right">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">1 Jan 2020</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi Anti-Fraude TVA (Certification Caisse)</h2>
      <span class="target-tag">Cible : Logiciels de Caisse & Encaissement</span>
      <p>Obligation de certification NF 525 pour tout logiciel de caisse ou syst√®me d'encaissement. Conditions : inalt√©rabilit√©, s√©curisation, conservation et archivage des donn√©es. Attestation obligatoire √† pr√©senter en cas de contr√¥le fiscal. Sanctions : amende 7500‚Ç¨ par logiciel non conforme. Concerne points de vente, e-commerce avec caisse int√©gr√©e, apps mobiles encaissement.</p>
      <a href="https://www.legifrance.gouv.fr/eli/loi/2015/12/29/2015-1785/jo/texte" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2015-1785 (Art. 88)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-antifraude')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal Anti-Fraude TVA -->
  <div class="obligations-modal" id="modal-antifraude">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Certification Caisse NF 525</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-antifraude')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour √âditeurs de Logiciels de Caisse</h4>
        <ul>
          <li><strong>Obtenir la certification NF 525</strong> aupr√®s d'un organisme accr√©dit√© (LNE, INFOCERT...)</li>
          <li><strong>Garantir l'inalt√©rabilit√©</strong> : donn√©es de caisse non modifiables a posteriori, scellement cryptographique</li>
          <li><strong>S√©curiser</strong> : cl√¥tures journali√®res, num√©rotation continue tickets, tra√ßabilit√© modifications</li>
          <li><strong>Archiver</strong> : conservation s√©curis√©e des donn√©es 6 ans minimum, exports aux formats r√©glementaires</li>
          <li><strong>Fournir une attestation</strong> au commer√ßant utilisateur (certificat de conformit√© individuel)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> 7 500‚Ç¨ d'amende par logiciel/caisse non conforme. Contr√¥les fiscaux renforc√©s depuis 2018.
        </div>
        <h4>üõí Logiciels Concern√©s</h4>
        <ul>
          <li>Logiciels de caisse points de vente (retail, restauration...)</li>
          <li>Applications mobiles d'encaissement (mPOS)</li>
          <li>Syst√®mes e-commerce avec module caisse int√©gr√©</li>
          <li>Syst√®mes de gestion commerciale avec facturation/encaissement</li>
        </ul>
        <h4>üìÑ Pour Commer√ßants Utilisateurs</h4>
        <ul>
          <li><strong>V√©rifier la certification NF 525</strong> du logiciel utilis√©</li>
          <li><strong>Conserver l'attestation</strong> de conformit√© fournie par l'√©diteur</li>
          <li><strong>Pr√©senter l'attestation</strong> en cas de contr√¥le fiscal</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2c card-esn">
      <div class="header-row">
        <span class="date-badge">12 Juil 2020</span>
        <span class="origin-badge origin-eu">Europe (Arr√™t)</span>
      </div>
      <h2>Schrems II (Transferts UE-USA)</h2>
      <span class="target-tag">Cible : SaaS utilisant h√©bergeurs US<span class="esn-info">ESN : Si utilisation AWS/Azure/GCP - TIA obligatoire</span></span>
      <p>Invalidation du Privacy Shield. Transferts de donn√©es hors UE n√©cessitent clauses contractuelles types (CCT) et analyse d'impact obligatoire (TIA - Transfer Impact Assessment). Risque accru avec h√©bergeurs soumis au CLOUD Act (AWS, Azure, GCP). Obligation d'√©valuer les lois du pays tiers (surveillance gouvernementale). Mesures suppl√©mentaires requises : chiffrement bout-en-bout, cl√©s gestion UE, pseudonymisation. Solutions √©mergentes : Data Clean Rooms, Confidential Computing (enclaves s√©curis√©es). Alternative : h√©bergement 100% UE souverain.</p>
      <a href="https://curia.europa.eu/juris/document/document.jsf?docid=228677" target="_blank" class="reg-link">üìÑ Arr√™t C-311/18</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-schrems')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal Schrems II -->
  <div class="obligations-modal" id="modal-schrems">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Schrems II / Transferts Hors UE</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-schrems')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Si Transfert Donn√©es Hors UE</h4>
        <ul>
          <li><strong>R√©aliser une TIA</strong> (Transfer Impact Assessment) : √©valuer les lois du pays destinataire (surveillance, acc√®s gouvernemental)</li>
          <li><strong>Signer des CCT</strong> (Clauses Contractuelles Types) avec le sous-traitant/partenaire</li>
          <li><strong>Documenter les garanties</strong> suppl√©mentaires mises en place (chiffrement, gestion cl√©s UE, pseudonymisation)</li>
          <li><strong>Informer les utilisateurs</strong> des transferts dans la politique de confidentialit√©</li>
          <li><strong>Pr√©voir des alternatives UE</strong> si risque trop √©lev√© (Cloud Act, FISA 702...)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Risque :</strong> H√©bergeurs US (AWS, Azure, GCP) soumis au CLOUD Act. Privacy Shield invalide depuis 2020.
        </div>
        <h4>üîê Mesures Techniques Suppl√©mentaires</h4>
        <ul>
          <li>Chiffrement bout-en-bout avec cl√©s g√©r√©es uniquement en UE</li>
          <li>Pseudonymisation ou anonymisation des donn√©es transf√©r√©es</li>
          <li>Data Clean Rooms (traitement en environnement s√©curis√© sans acc√®s direct)</li>
          <li>Confidential Computing (enclaves TEE, attestation distance)</li>
          <li>Alternative : h√©bergement 100% UE souverain (OVHcloud, Scaleway, Outscale...)</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container right">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">24 Nov 2020</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Accessibilit√© Num√©rique (RGAA)</h2>
      <span class="target-tag">Cible : Sites publics & grandes entreprises</span>
      <p>Obligation de conformit√© RGAA (R√©f√©rentiel G√©n√©ral d'Am√©lioration de l'Accessibilit√©) pour les sites web et applications mobiles des organismes publics et entreprises >250M‚Ç¨ CA. Niveau minimum : AA (WCAG 2.1). D√©claration d'accessibilit√© obligatoire. Sch√©ma pluriannuel de mise en conformit√©. Sanctions : jusqu'√† 20 000‚Ç¨ par site non conforme. Concern√© : lecteurs √©cran, navigation clavier, contraste couleurs, sous-titres vid√©o.</p>
      <a href="https://www.legifrance.gouv.fr/eli/decret/2019/7/24/2019-768/jo/texte" target="_blank" class="reg-link">üìÑ D√©cret n¬∞ 2019-768</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-rgaa')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal RGAA -->
  <div class="obligations-modal" id="modal-rgaa">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - RGAA / Accessibilit√© Num√©rique</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-rgaa')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Organismes Publics</h4>
        <ul>
          <li><strong>Conformit√© RGAA niveau AA minimum</strong> (WCAG 2.1)</li>
          <li><strong>Publier d√©claration d'accessibilit√©</strong> sur chaque site/app</li>
          <li><strong>√âtablir sch√©ma pluriannuel</strong> (3 ans max) + plan d'action annuel</li>
          <li><strong>Moyen de contact</strong> pour signaler probl√®mes accessibilit√©</li>
        </ul>
        <h4>üè¢ Pour Entreprises >250M‚Ç¨ CA</h4>
        <ul>
          <li>M√™mes obligations pour sites/apps g√©n√©rant >250M‚Ç¨ CA annuel France</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Jusqu'√† 20 000‚Ç¨ par site apr√®s mise en demeure.
        </div>
        <h4>‚ôø Crit√®res Cl√©s</h4>
        <ul>
          <li>Navigation clavier compl√®te</li>
          <li>Compatibilit√© lecteurs √©cran</li>
          <li>Contraste 4.5:1 minimum</li>
          <li>Sous-titres vid√©os, alt images</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container left">
    <div class="content card-iot">
      <div class="header-row">
        <span class="date-badge">1 Jan 2021</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi AGEC (Indice de R√©parabilit√©)</h2>
      <span class="target-tag">Cible : OS, Logiciels embarqu√©s</span>
      <p>Le calcul de la r√©parabilit√© des √©quipements inclut d√©sormais la dur√©e de disponibilit√© des mises √† jour logicielles. Impact sur smartphones, tablettes, ordinateurs portables. Obligation d'affichage en magasin et en ligne (note sur 10).</p>
      <a href="https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000041553759" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2020-105 (AGEC)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-agec')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal AGEC -->
  <div class="obligations-modal" id="modal-agec">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - AGEC / Indice R√©parabilit√©</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-agec')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Fabricants √âquipements √âlectroniques</h4>
        <ul>
          <li><strong>Calculer l'indice de r√©parabilit√©</strong> selon grille officielle (note /10)</li>
          <li><strong>Int√©grer la dur√©e support logiciel</strong> : nombre d'ann√©es de mises √† jour garanties (OS, firmware, correctifs s√©cu)</li>
          <li><strong>Afficher l'indice</strong> : point de vente physique + fiche produit en ligne (obligatoire)</li>
          <li><strong>Publier la grille de calcul</strong> d√©taill√©e en ligne (site fabricant)</li>
        </ul>
        <h4>üì± √âquipements Concern√©s</h4>
        <ul>
          <li>Smartphones et tablettes</li>
          <li>Ordinateurs portables</li>
          <li>T√©l√©viseurs</li>
          <li>Lave-linge, tondeuses √† gazon (√©largissement progressif)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üìä Impact logiciel :</strong> La dur√©e de disponibilit√© des mises √† jour (OS, s√©curit√©) compte pour 20% de la note finale.
        </div>
        <h4>üõ†Ô∏è Pour √âditeurs OS/Firmware Embarqu√©s</h4>
        <ul>
          <li><strong>Annoncer publiquement</strong> la dur√©e de support (ex: "5 ans de mises √† jour")</li>
          <li><strong>Respecter l'engagement</strong> : fournir mises √† jour s√©curit√© + correctifs critiques</li>
          <li><strong>Informer en cas d'arr√™t</strong> du support (fin de vie produit)</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">7 Sept 2021</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Directive Copyright (Upload Filters)</h2>
      <span class="target-tag">Cible : Plateformes UGC, R√©seaux Sociaux</span>
      <p>Obligation de filtrage automatique des contenus prot√©g√©s par droits d'auteur upload√©s par utilisateurs (Article 17). Filtres anti-contrefa√ßon obligatoires pour plateformes >5M users. Accords de licence pr√©alables avec ayants-droit requis. Proc√©dure contestation utilisateur obligatoire. Concerne YouTube, TikTok, Dailymotion, plateformes partage vid√©o/musique. Exemptions : startups <3 ans, <10M‚Ç¨ CA.</p>
      <a href="https://eur-lex.europa.eu/eli/dir/2019/790/oj" target="_blank" class="reg-link">üìÑ Directive (UE) 2019/790 (DSM)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-copyright')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">1 Jan 2022</span>
        <span class="origin-badge origin-fr">France (Transpo UE)</span>
      </div>
      <h2>Garantie L√©gale de Conformit√© Num√©rique</h2>
      <span class="target-tag">Cible : Editeurs B2C, Jeux, Apps</span>
      <p>Obligation de fournir les mises √† jour n√©cessaires au maintien de la conformit√© pendant 2 ans minimum pour les produits et services num√©riques vendus aux consommateurs. Transposition de la directive europ√©enne sur les contenus et services num√©riques. Le consommateur peut demander r√©paration, remplacement ou remboursement en cas de d√©faut.</p>
      <a href="https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000043884445" target="_blank" class="reg-link">üìÑ Ordonnance n¬∞ 2021-1247</a>
      <a href="https://eur-lex.europa.eu/eli/dir/2019/770/oj" target="_blank" class="reg-link">üìÑ Directive (UE) 2019/770</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-conformite')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal Garantie Conformit√© -->
  <div class="obligations-modal" id="modal-conformite">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Garantie Conformit√© Num√©rique</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-conformite')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour √âditeurs B2C (Vente Consommateurs)</h4>
        <ul>
          <li><strong>Fournir mises √† jour</strong> n√©cessaires au maintien de la conformit√© pendant <strong>2 ans minimum</strong></li>
          <li><strong>Informer le consommateur</strong> des mises √† jour disponibles (notifications, emails)</li>
          <li><strong>Garantir les fonctionnalit√©s</strong> annonc√©es √† la vente (description, publicit√©, d√©mo)</li>
          <li><strong>Assurer la s√©curit√©</strong> : correctifs vuln√©rabilit√©s critiques pendant 2 ans</li>
          <li><strong>Compatibilit√©</strong> : si int√©gration mat√©riel, garantir fonctionnement avec versions OS standard</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è D√©faut de conformit√© :</strong> Consommateur peut exiger r√©paration (correctif), remplacement ou remboursement (r√©solution contrat).
        </div>
        <h4>üì± Produits/Services Concern√©s</h4>
        <ul>
          <li>Applications mobiles vendues (Android, iOS)</li>
          <li>Logiciels PC/Mac vendus aux particuliers</li>
          <li>Jeux vid√©o (hors contenu purement en ligne multijoueur)</li>
          <li>SaaS B2C avec abonnement consommateur</li>
          <li>Contenus num√©riques (ebooks avec DRM, vid√©os, musique)</li>
        </ul>
        <h4>üïí Dur√©e Garantie</h4>
        <ul>
          <li><strong>2 ans minimum</strong> √† compter de la fourniture initiale</li>
          <li>Sauf si dur√©e plus longue annonc√©e contractuellement</li>
          <li>Pour abonnements : pendant toute la dur√©e + 2 ans apr√®s r√©siliation si achat unique</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">9 Juin 2023</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi Influenceurs</h2>
      <span class="target-tag">Cible : R√©seaux Sociaux, Plateformes</span>
      <p>Obligation technique d'afficher un bouton de signalement des contenus illicites et de traiter prioritairement les notifications des signaleurs de confiance. Encadrement strict de la promotion de certains produits (chirurgie esth√©tique, paris). Interdiction publicit√© pour enfants de moins de 16 ans sans consentement parental.</p>
      <a href="https://www.legifrance.gouv.fr/eli/loi/2023/6/9/2023-451/jo/texte" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2023-451 (Influenceurs)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-influenceurs')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">20 Sept 2023</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>eIDAS 2.0 (Identit√© Num√©rique)</h2>
      <span class="target-tag">Cible : Tout Service en Ligne, SSO, Auth</span>
      <p>Cr√©ation du Portefeuille Europ√©en d'Identit√© Num√©rique (EUDI Wallet) accessible √† tous les citoyens UE. Obligation pour services publics d'accepter l'authentification via wallet UE. Services priv√©s fortement encourag√©s (adoption volontaire). Permet stockage identit√©, permis, dipl√¥mes, prescriptions m√©dicales. Signature √©lectronique qualifi√©e int√©gr√©e. Impact majeur sur SSO/OAuth : interop√©rabilit√© paneurop√©enne obligatoire.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/1183/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/1183 (eIDAS 2)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-eidas')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">17 F√©v 2024</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Digital Services Act (DSA)</h2>
      <span class="target-tag">Cible : Marketplaces, H√©bergeurs</span>
      <p>Syst√®me de "Notice & Action" obligatoire (signalement + retrait contenus illicites). Tra√ßabilit√© des vendeurs pro (KYBC) obligatoire pour les places de march√©. Tr√®s grandes plateformes (>45M users UE) : audit annuel, analyse risques syst√©miques, transparence algorithmes. Point de contact unique UE obligatoire.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2022/2065/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2022/2065 (DSA)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-dsa')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">2 Mars 2024</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>DMA (Digital Markets Act)</h2>
      <span class="target-tag">Cible : Gatekeepers (Apple, Google, Meta...)</span>
      <p>Obligation d'interop√©rabilit√© pour les "contr√¥leurs d'acc√®s" (>45M users UE mensuels, >75M‚Ç¨ CA UE). Messageries instantan√©es doivent s'ouvrir (WhatsApp, iMessage). App Stores : autorisation side-loading, stores tiers, moteurs paiement alternatifs. Interdiction auto-pr√©f√©rence (favoriser ses propres services dans classements). Acc√®s aux donn√©es plateforme pour tiers. Portabilit√© donn√©es en temps r√©el. Sanctions : jusqu'√† 10% CA mondial, 20% en r√©cidive.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2022/1925/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2022/1925 (DMA)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-dma')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">22 Mai 2024</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi SREN</h2>
      <span class="target-tag">Cible : Cloud, Sites Adultes</span>
      <p>Encadrement des cr√©dits cloud (dur√©e limit√©e √† 12 mois, remboursement obligatoire). Obligation de v√©rification d'√¢ge stricte pour les sites pornographiques (double anonymat). Blocage DNS possible ordonn√© par Arcom. Renforcement lutte contre arnaques en ligne et contrefa√ßons. Obligation h√©bergeurs : contact France, repr√©sentant l√©gal UE.</p>
      <a href="https://www.legifrance.gouv.fr/eli/loi/2024/5/21/2024-449/jo/texte" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2024-449 (SREN)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-sren')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2b card-esn">
      <div class="header-row">
        <span class="date-badge">18 Oct 2024</span>
        <span class="origin-badge origin-fr">France (Transpo UE)</span>
      </div>
      <h2>NIS 2 (Cybers√©curit√© Renforc√©e)</h2>
      <span class="target-tag">Cible : SaaS B2B >50 salari√©s, ESN<span class="esn-info">ESN : >50 sal. Important / >250 sal. ou >50M‚Ç¨ Essentiel</span></span>
      <p>Transposition fran√ßaise effective. Obligation d'auto-recensement ANSSI pour entit√©s essentielles (>250 sal. ou >50M‚Ç¨ CA) et importantes (>50 sal.). Notification incidents majeurs sous 24h. Mesures cybers√©curit√© obligatoires : MFA, chiffrement, sauvegardes, gestion correctifs, analyse risques annuelle. Sanctions : jusqu'√† 10M‚Ç¨ ou 2% CA. Responsabilit√© personnelle dirigeants possible.</p>
      <a href="https://eur-lex.europa.eu/eli/dir/2022/2555/oj" target="_blank" class="reg-link">üìÑ Directive (UE) 2022/2555 (NIS 2)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-nis2')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-regulated card-esn">
      <div class="header-row">
        <span class="date-badge">17 Jan 2025</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>DORA (Entr√©e en vigueur)</h2>
      <span class="target-tag">Cible : Fintech, SaaS Bancaire<span class="esn-info">ESN : Si prestataire TIC pour secteur financier</span></span>
      <p>Contrats de r√©silience informatique obligatoires avec les clients financiers. Surveillance directe des prestataires TIC critiques par l'UE (ESA). Tests de r√©silience obligatoires (TLPT - Threat-Led Penetration Testing tous les 3 ans). Notification incidents sous 4h (initial) puis rapports d√©taill√©s. Registre des risques TIC. Due diligence fournisseurs renforc√©e. En France : qualification SecNumCloud ANSSI ou √©quivalent fortement recommand√©e pour h√©bergeurs de donn√©es financi√®res sensibles.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2022/2554/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2022/2554 (DORA)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-dora')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal card-esn">
      <div class="header-row">
        <span class="date-badge">2 F√©v 2025</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>AI Act (Interdictions)</h2>
      <span class="target-tag">Cible : Tous D√©veloppeurs IA<span class="esn-info">ESN : Si d√©veloppement solutions IA pour clients</span></span>
      <p>Interdiction de mise sur le march√© d'IA aux pratiques inacceptables (notation sociale, police pr√©dictive, reconnaissance √©motionnelle au travail, manipulation comportementale). IA √† haut risque (recrutement, cr√©dit, justice) : √©valuation conformit√© obligatoire, supervision humaine. IA g√©n√©rative (GPAI - General Purpose AI) : transparence (watermarking, mention "g√©n√©r√© par IA"), documentation technique, r√©sum√© donn√©es entra√Ænement. Mod√®les √† risque syst√©mique (>10^25 FLOPS) : tests adversaires obligatoires. Sanctions jusqu'√† 35M‚Ç¨ ou 7% CA.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/1689/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/1689 (AI Act)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-aiact')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-iot">
      <div class="header-row">
        <span class="date-badge">12 Sept 2025</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Data Act (Acc√®s IoT)</h2>
      <span class="target-tag">Cible : SaaS IoT, Industrie</span>
      <p>Obligation de fournir aux utilisateurs l'acc√®s aux donn√©es brutes g√©n√©r√©es par leurs objets connect√©s. Droit de partager ces donn√©es avec des tiers (r√©parateurs, services apr√®s-vente). API standardis√©es obligatoires. Interdiction des clauses contractuelles bloquant l'acc√®s aux donn√©es. D√©lai de mise √† disposition : sans retard injustifi√©.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2023/2854/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2023/2854 (Data Act)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-dataact-iot')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-iot">
      <div class="header-row">
        <span class="date-badge">Juil 2026</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>ESPR (Passeport Num√©rique)</h2>
      <span class="target-tag">Cible : ERP, PLM, Supply Chain</span>
      <p>Mise en place du registre pour le Passeport Num√©rique Produit (DPP). Impact fort sur les logiciels de gestion de production (Textile/Batteries). Tra√ßabilit√© compl√®te obligatoire : composition, r√©parabilit√©, empreinte carbone, recyclabilit√©. QR code ou RFID sur produits. Les logiciels doivent int√©grer capacit√© de g√©n√©ration et stockage DPP.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/1781/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/1781 (ESPR)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-espr')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">1 Sept 2026</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Facturation √âlectronique (V1)</h2>
      <span class="target-tag">Cible : Logiciels de Gestion / Compta</span>
      <p>Capacit√© de <strong>r√©ception</strong> obligatoire pour toutes les entreprises. <strong>√âmission</strong> obligatoire pour les Grandes Entreprises et ETI. Formats : Factur-X (hybride PDF/XML) ou UBL. Transmission via plateformes de d√©mat√©rialisation partenaires (PDP) ou portail public (PPF). e-Reporting des transactions B2C/export simultan√©. Certification NF 203 recommand√©e.</p>
      <a href="https://www.legifrance.gouv.fr/eli/ordonnance/2024/6/5/2024-640/jo/texte" target="_blank" class="reg-link">üìÑ Ordonnance n¬∞ 2024-640</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-facture-v1')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal card-esn">
      <div class="header-row">
        <span class="date-badge">Sept 2026</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Cyber Resilience Act (Reporting)</h2>
      <span class="target-tag">Cible : Tout Editeur Logiciel<span class="esn-info">ESN : Si √©dition logiciels commerciaux</span></span>
      <p>Obligation de signaler les vuln√©rabilit√©s activement exploit√©es √† l'ENISA et au CSIRT national sous 24 heures. Vuln√©rabilit√©s non exploit√©es : notification sous 72h apr√®s d√©couverte. Publication coordonn√©e (CVD) recommand√©e. Base EUDB centralis√©e. Premiers √©diteurs concern√©s : logiciels avec connexion r√©seau ou traitement de donn√©es sensibles.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/2847/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/2847 (CRA)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-cra-reporting')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">12 Jan 2027</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Data Act (Cloud Switching)</h2>
      <span class="target-tag">Cible : Fournisseurs Cloud / IaaS / PaaS</span>
      <p>Interdiction totale de facturer des frais de sortie (Egress fees) ou de changement de fournisseur. D√©lai maximal de migration : 30 jours (donn√©es) + 30 jours (assistance technique). Export des donn√©es dans format structur√© et machine-readable obligatoire. Clauses contractuelles abusives interdites (p√©nalit√©s dissuasives, verrouillage technique). Concerne IaaS, PaaS, SaaS avec stockage important.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2023/2854/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2023/2854 (Data Act)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-dataact-cloud')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">1 Sept 2027</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Facturation √âlectronique (V2)</h2>
      <span class="target-tag">Cible : Logiciels pour PME/TPE</span>
      <p>G√©n√©ralisation : L'√©mission de factures √©lectroniques structur√©es devient obligatoire pour les PME et TPE. Fin du papier et PDF simple pour B2B. Tous les logiciels de facturation/compta/ERP/CRM doivent int√©grer connexion √† une PDP ou au PPF. Archivage √©lectronique 10 ans obligatoire. Contr√¥les fiscaux automatis√©s accrus (TVA, d√©tection fraude).</p>
      <a href="https://www.legifrance.gouv.fr/eli/ordonnance/2024/6/5/2024-640/jo/texte" target="_blank" class="reg-link">üìÑ Ordonnance n¬∞ 2024-640</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-facture-v2')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-universal card-esn">
      <div class="header-row">
        <span class="date-badge">D√©c 2027</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Cyber Resilience Act (Total)</h2>
      <span class="target-tag">Cible : Tout Logiciel Commercial<span class="esn-info">ESN : Marquage CE + SBOM si √©dition logiciel</span></span>
      <p>Marquage CE obligatoire. Security by Design, livraison de SBOM (liste composants) et support de s√©curit√© garanti 5 ans minimum. Produits "critiques" : Classe I (OS, antivirus, VPN, gestionnaires mots de passe) et Classe II (syst√®mes industriels critiques, firewalls) n√©cessitent certification tierce obligatoire. Documentation technique compl√®te : analyse risques, tests s√©curit√©, instructions utilisateurs. Logiciels open-source commercialis√©s inclus. Sanctions : jusqu'√† 15M‚Ç¨ ou 2.5% CA. Exemptions : SaaS pur sans composant t√©l√©charg√©/install√© c√¥t√© client.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/2847/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/2847 (CRA)</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-cra-total')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container left">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">2027 (Est.)</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>DSP3 / PSR (Payment Services Regulation)</h2>
      <span class="target-tag">Cible : Fintech, E-commerce, PSP</span>
      <p>V√©rification obligatoire IBAN/Nom du b√©n√©ficiaire pour tous les virements (lutte fraude). Renforcement APIs Open Banking : acc√®s temps r√©el, dashboards unifi√©s, initiation paiement facilit√©e. Autorisation paiements instantan√©s paneurop√©ens obligatoires. Obligation banques : APIs standardis√©es gratuites. Nouveau r√©gime agr√©ment PSP simplifi√©. SaaS √©trangers avec clients FR concern√©s.</p>
      <a href="https://finance.ec.europa.eu/regulation-and-supervision/financial-services-legislation/implementing-and-delegated-acts/payment-services-directive-psd2_en" target="_blank" class="reg-link">üìÑ PSR - Proposition COM/2023</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-dsp3')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <div class="container right">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">2028 (Est.)</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>EHDS (Espace Europ√©en Donn√©es Sant√©)</h2>
      <span class="target-tag">Cible : Logiciels Sant√© (DPI, Imagerie)</span>
      <p>Obligation d'interop√©rabilit√© europ√©enne pour dossiers patients (r√©sum√© patient, e-prescription) selon format EEHRxF. Acc√®s transfrontalier aux donn√©es sant√© pour soins. Consentement patient centralis√©. Espace europ√©en donn√©es sant√© pour recherche (usage secondaire). Logiciels DPI, imagerie, labo concern√©s. Certification produits sant√© num√©riques renforc√©e. Pilotes nationaux d√®s 2026.</p>
      <a href="https://health.ec.europa.eu/publications/proposal-regulation-european-health-data-space_en" target="_blank" class="reg-link">üìÑ EHDS - Proposition COM/2022</a>
      <button class="obligations-btn" onclick="openObligationsModal('modal-ehds')">
        üìã Mes obligations
      </button>
    </div>
  </div>

  <!-- Modal Directive Copyright -->
  <div class="obligations-modal" id="modal-copyright">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Directive Copyright / Upload Filters</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-copyright')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Plateformes UGC >5M Users</h4>
        <ul>
          <li><strong>Filtrage automatique</strong> contenus prot√©g√©s (Article 17) avant publication</li>
          <li><strong>N√©gocier licences</strong> avec ayants-droit (SACEM, SACD, √©diteurs...)</li>
          <li><strong>Proc√©dure contestation</strong> utilisateur (recours si faux positif)</li>
          <li><strong>Analyse contenus</strong> : empreintes num√©riques (fingerprinting vid√©o/audio)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Exemption :</strong> Startups <3 ans ET <10M‚Ç¨ CA exempt√©es temporairement.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Loi Influenceurs -->
  <div class="obligations-modal" id="modal-influenceurs">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Loi Influenceurs</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-influenceurs')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Plateformes/R√©seaux Sociaux</h4>
        <ul>
          <li><strong>Bouton signalement</strong> contenus illicites visible</li>
          <li><strong>Traitement prioritaire</strong> signalements de confiance</li>
          <li><strong>Blocage publicit√©</strong> produits interdits (chirurgie esth√©tique, paris sportifs)</li>
          <li><strong>V√©rification √¢ge</strong> pour publicit√© ciblant -16 ans</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal eIDAS 2.0 -->
  <div class="obligations-modal" id="modal-eidas">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - eIDAS 2.0 / Wallet Europ√©en</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-eidas')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Services Publics (Obligatoire)</h4>
        <ul>
          <li><strong>Accepter authentification</strong> via EUDI Wallet</li>
          <li><strong>Int√©gration SSO</strong> compatible wallet UE</li>
        </ul>
        <h4>üí° Pour Services Priv√©s (Recommand√©)</h4>
        <ul>
          <li><strong>Adoption volontaire</strong> fortement encourag√©e</li>
          <li><strong>Interop√©rabilit√© OAuth/OpenID</strong> avec wallet UE</li>
          <li>Permet authentification unifi√©e citoyens UE</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal DMA -->
  <div class="obligations-modal" id="modal-dma">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - DMA / Gatekeepers</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-dma')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Si Gatekeeper (>45M Users UE, >75M‚Ç¨ CA)</h4>
        <ul>
          <li><strong>Interop√©rabilit√©</strong> : ouvrir messageries (WhatsApp, iMessage)</li>
          <li><strong>App Stores</strong> : autoriser side-loading, stores tiers, moteurs paiement alternatifs</li>
          <li><strong>Interdiction auto-pr√©f√©rence</strong> : ne pas favoriser ses services dans classements</li>
          <li><strong>Portabilit√© donn√©es</strong> temps r√©el pour utilisateurs</li>
          <li><strong>Acc√®s donn√©es</strong> pour d√©veloppeurs tiers (APIs)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Jusqu'√† 10% CA mondial, 20% r√©cidive.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal DSA -->
  <div class="obligations-modal" id="modal-dsa">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - DSA</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-dsa')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Toutes Plateformes/H√©bergeurs</h4>
        <ul>
          <li><strong>Syst√®me "Notice & Action"</strong> : signalement + retrait contenus illicites</li>
          <li><strong>Point de contact UE</strong> obligatoire</li>
        </ul>
        <h4>üè™ Pour Marketplaces</h4>
        <ul>
          <li><strong>KYBC (Know Your Business Customer)</strong> : tra√ßabilit√© vendeurs professionnels</li>
          <li>V√©rification identit√©, SIRET, coordonn√©es bancaires</li>
        </ul>
        <h4>üè¢ Si Tr√®s Grande Plateforme (>45M Users UE)</h4>
        <ul>
          <li><strong>Audit ind√©pendant annuel</strong></li>
          <li><strong>Analyse risques syst√©miques</strong> (d√©sinformation, manipulation...)</li>
          <li><strong>Transparence algorithmes</strong> recommandation</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal SREN -->
  <div class="obligations-modal" id="modal-sren">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Loi SREN</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-sren')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚òÅÔ∏è Pour Fournisseurs Cloud</h4>
        <ul>
          <li><strong>Cr√©dits cloud</strong> : dur√©e max 12 mois, remboursement non utilis√© obligatoire</li>
          <li><strong>Repr√©sentant l√©gal UE</strong> et contact France</li>
        </ul>
        <h4>üîû Pour Sites Adultes</h4>
        <ul>
          <li><strong>V√©rification √¢ge stricte</strong> avec double anonymat (pas de tra√ßabilit√©)</li>
          <li>Solutions certifi√©es (FranceConnect+, tiers certificateurs)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Blocage DNS administratif possible par Arcom sans juge.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal DORA -->
  <div class="obligations-modal" id="modal-dora">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - DORA (Depuis 17 Jan 2025)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-dora')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Prestataires TIC Secteur Financier</h4>
        <ul>
          <li><strong>Contrats r√©silience</strong> avec clauses obligations cyber pr√©cises</li>
          <li><strong>Notification incidents</strong> sous 4h (initial) + rapports d√©taill√©s</li>
          <li><strong>Tests r√©silience TLPT</strong> (Threat-Led Penetration Testing) tous les 3 ans</li>
          <li><strong>Registre risques TIC</strong> document√© et √† jour</li>
          <li><strong>Due diligence fournisseurs</strong> sous-traitants</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üá´üá∑ France :</strong> SecNumCloud ANSSI fortement recommand√© pour h√©bergement donn√©es financi√®res sensibles.
        </div>
        <h4>üéØ Si Prestataire TIC Critique</h4>
        <ul>
          <li><strong>Surveillance directe ESA</strong> (autorit√©s europ√©ennes)</li>
          <li>Audits r√©guliers impos√©s</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal AI Act -->
  <div class="obligations-modal" id="modal-aiact">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - AI Act (Depuis 2 F√©v 2025)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-aiact')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>üö´ Interdictions Imm√©diates</h4>
        <ul>
          <li>Notation sociale (type cr√©dit social chinois)</li>
          <li>Police pr√©dictive bas√©e profils</li>
          <li>Reconnaissance √©motionnelle au travail/√©coles</li>
          <li>Manipulation comportementale subliminale</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Jusqu'√† 35M‚Ç¨ ou 7% CA pour pratiques interdites.
        </div>
        <h4>‚ö†Ô∏è Si IA Haut Risque (Recrutement, Cr√©dit, Justice...)</h4>
        <ul>
          <li><strong>√âvaluation conformit√©</strong> avant mise sur march√©</li>
          <li><strong>Supervision humaine</strong> obligatoire</li>
          <li><strong>Documentation technique</strong> compl√®te</li>
          <li><strong>Tests robustesse</strong> et biais</li>
        </ul>
        <h4>ü§ñ Si IA G√©n√©rative (GPAI)</h4>
        <ul>
          <li><strong>Watermarking</strong> contenus g√©n√©r√©s</li>
          <li><strong>Mention "g√©n√©r√© par IA"</strong> obligatoire</li>
          <li><strong>R√©sum√© donn√©es entra√Ænement</strong> publi√©</li>
          <li>Si >10^25 FLOPS : tests adversaires obligatoires</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal Data Act IoT -->
  <div class="obligations-modal" id="modal-dataact-iot">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Data Act / Acc√®s Donn√©es IoT (Depuis 12 Sept 2025)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-dataact-iot')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Fabricants/√âditeurs IoT</h4>
        <ul>
          <li><strong>Fournir acc√®s donn√©es brutes</strong> g√©n√©r√©es par objets connect√©s aux utilisateurs</li>
          <li><strong>API standardis√©es</strong> pour export donn√©es</li>
          <li><strong>Autoriser partage tiers</strong> (r√©parateurs, SAV, services tiers)</li>
          <li><strong>D√©lai mise √† disposition</strong> : sans retard injustifi√© (temps r√©el ou quasi)</li>
          <li><strong>Interdiction clauses bloquantes</strong> dans CGV (acc√®s exclusif √©diteur)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üéØ Objectif :</strong> Droit de r√©paration et libert√© choix services pour utilisateurs finaux.
        </div>
        <h4>üìä Donn√©es Concern√©es</h4>
        <ul>
          <li>Capteurs IoT (temp√©rature, g√©olocalisation, consommation...)</li>
          <li>Logs √©quipements industriels</li>
          <li>T√©l√©m√©trie v√©hicules connect√©s</li>
          <li>Historiques usage appareils domestiques</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal NIS 2 -->
  <div class="obligations-modal" id="modal-nis2">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - NIS 2 (Depuis 18 Oct 2024)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-nis2')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Entit√©s Essentielles (>250 sal. OU >50M‚Ç¨ CA)</h4>
        <ul>
          <li><strong>Auto-recensement ANSSI</strong> via plateforme d√©di√©e</li>
          <li><strong>Notification incidents</strong> cyber majeurs sous 24h</li>
          <li><strong>Mesures cybers√©curit√©</strong> : MFA, chiffrement, sauvegardes 3-2-1, gestion correctifs</li>
          <li><strong>Analyse risques annuelle</strong> document√©e</li>
          <li><strong>Plan continuit√© activit√©</strong> (PCA/PRA) test√©</li>
          <li><strong>Formation personnel</strong> cybers√©curit√©</li>
        </ul>
        <h4>‚úÖ Pour Entit√©s Importantes (>50 sal.)</h4>
        <ul>
          <li>M√™mes obligations mais surveillance moins stricte</li>
          <li>Auto-recensement ANSSI requis</li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚ö†Ô∏è Sanctions :</strong> Jusqu'√† 10M‚Ç¨ ou 2% CA. Responsabilit√© personnelle dirigeants possible.
        </div>
        <h4>üéØ Secteurs Concern√©s</h4>
        <ul>
          <li>SaaS B2B, ESN, Cloud providers</li>
          <li>Services num√©riques (>50 salari√©s)</li>
          <li>Sant√©, √©nergie, transports, finance (essentiels)</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal ESPR -->
  <div class="obligations-modal" id="modal-espr">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - ESPR / Passeport Num√©rique Produit (Juil 2026)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-espr')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour √âditeurs ERP/PLM/Supply Chain</h4>
        <ul>
          <li><strong>Int√©grer module DPP</strong> (Digital Product Passport) dans logiciel</li>
          <li><strong>G√©n√©rer QR codes/RFID</strong> pour chaque produit</li>
          <li><strong>Stocker donn√©es tra√ßabilit√©</strong> : composition, origine, r√©parabilit√©, empreinte carbone</li>
          <li><strong>API export vers registre UE</strong></li>
        </ul>
        <h4>üè≠ Secteurs Prioritaires (2026)</h4>
        <ul>
          <li>Textile & habillement</li>
          <li>Batteries (v√©hicules √©lectriques)</li>
          <li>√âlectronique (2027)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üìä Impact :</strong> Logiciels de gestion production doivent capturer et stocker donn√©es durabilit√© d√®s conception.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Facturation √âlectronique V1 -->
  <div class="obligations-modal" id="modal-facture-v1">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Facturation √âlectronique V1 (1 Sept 2026)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-facture-v1')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour TOUTES Entreprises</h4>
        <ul>
          <li><strong>Capacit√© r√©ception</strong> factures √©lectroniques structur√©es obligatoire</li>
          <li>Formats : Factur-X (PDF/XML hybride) ou UBL</li>
          <li>Via PDP (Plateforme D√©mat√©rialisation Partenaire) ou PPF (Portail Public)</li>
        </ul>
        <h4>üì§ Pour Grandes Entreprises & ETI (√âmission)</h4>
        <ul>
          <li><strong>√âmission obligatoire</strong> factures B2B structur√©es</li>
          <li><strong>e-Reporting</strong> : d√©claration transactions B2C et exports</li>
          <li><strong>Connexion PDP/PPF</strong> int√©gr√©e au logiciel</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üá´üá∑ Certification NF 203</strong> recommand√©e pour logiciels de facturation.
        </div>
        <h4>üíª Pour √âditeurs Logiciels</h4>
        <ul>
          <li><strong>Int√©grer connecteurs</strong> PDP certifi√©es ou API PPF</li>
          <li><strong>G√©n√©ration Factur-X/UBL</strong></li>
          <li><strong>Archivage 10 ans</strong> conforme</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal CRA Reporting -->
  <div class="obligations-modal" id="modal-cra-reporting">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - CRA Reporting Vuln√©rabilit√©s (Sept 2026)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-cra-reporting')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Tous √âditeurs Logiciels</h4>
        <ul>
          <li><strong>Notifier ENISA + CSIRT national</strong> sous 24h si vuln√©rabilit√© activement exploit√©e</li>
          <li><strong>Notifier sous 72h</strong> si vuln√©rabilit√© d√©couverte non exploit√©e</li>
          <li><strong>Enregistrement base EUDB</strong> centralis√©e europ√©enne</li>
          <li><strong>CVD (Coordinated Vulnerability Disclosure)</strong> : publication coordonn√©e apr√®s correctif</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üéØ Concern√©s d√®s 2026 :</strong> Logiciels avec connexion r√©seau ou traitement donn√©es sensibles.
        </div>
        <h4>üìã Informations √† Fournir</h4>
        <ul>
          <li>Description technique vuln√©rabilit√© (CVE)</li>
          <li>Versions affect√©es</li>
          <li>Criticit√© (CVSS score)</li>
          <li>Correctif disponible ou workaround</li>
          <li>Exploitation constat√©e (IoC)</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal Data Act Cloud Switching -->
  <div class="obligations-modal" id="modal-dataact-cloud">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Data Act / Cloud Switching (12 Jan 2027)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-dataact-cloud')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Fournisseurs IaaS/PaaS/SaaS</h4>
        <ul>
          <li><strong>Interdiction frais sortie</strong> (egress fees) totale</li>
          <li><strong>Interdiction frais changement</strong> fournisseur</li>
          <li><strong>D√©lai migration max</strong> : 30 jours donn√©es + 30 jours assistance technique</li>
          <li><strong>Export format structur√©</strong> machine-readable obligatoire</li>
          <li><strong>Interdiction clauses abusives</strong> : p√©nalit√©s dissuasives, verrouillage technique</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üí∞ Impact :</strong> Fin des revenus egress (AWS, Azure, GCP). Portabilit√© totale clients.
        </div>
        <h4>üì§ Obligations Techniques</h4>
        <ul>
          <li>API export compl√®te (donn√©es + configs)</li>
          <li>Formats standards (JSON, CSV, SQL...)</li>
          <li>Assistance migration gratuite (30j)</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal Facturation √âlectronique V2 -->
  <div class="obligations-modal" id="modal-facture-v2">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - Facturation √âlectronique V2 (1 Sept 2027)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-facture-v2')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour PME & TPE (√âmission Obligatoire)</h4>
        <ul>
          <li><strong>√âmission factures structur√©es</strong> B2B obligatoire (Factur-X ou UBL)</li>
          <li><strong>Fin PDF simple</strong> et papier pour B2B</li>
          <li><strong>Connexion PDP/PPF</strong> : tous logiciels compta/ERP/CRM doivent int√©grer</li>
          <li><strong>e-Reporting</strong> transactions B2C/export obligatoire</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üö® G√©n√©ralisation totale :</strong> Toutes entreprises fran√ßaises B2B concern√©es.
        </div>
        <h4>üíª Pour √âditeurs Logiciels PME/TPE</h4>
        <ul>
          <li><strong>Mise √† jour obligatoire</strong> : int√©gration connecteurs facture √©lectronique</li>
          <li><strong>Interface utilisateur</strong> simplifi√©e pour TPE</li>
          <li><strong>Archivage 10 ans</strong> conforme fiscal</li>
        </ul>
        <h4>üìä Impact Fiscal</h4>
        <ul>
          <li>Pr√©-remplissage TVA automatique</li>
          <li>Contr√¥les fiscaux automatis√©s accrus</li>
          <li>D√©tection fraude temps r√©el</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal CRA Total -->
  <div class="obligations-modal" id="modal-cra-total">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - CRA Complet (D√©c 2027)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-cra-total')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Tous Logiciels Commerciaux</h4>
        <ul>
          <li><strong>Marquage CE obligatoire</strong></li>
          <li><strong>Security by Design</strong> : analyse risques d√®s conception</li>
          <li><strong>SBOM (Software Bill of Materials)</strong> : liste tous composants/d√©pendances</li>
          <li><strong>Support s√©curit√© 5 ans minimum</strong> : correctifs vuln√©rabilit√©s critiques</li>
          <li><strong>Documentation technique</strong> : tests s√©curit√©, instructions utilisateur</li>
        </ul>
        <h4>üî¥ Si Classe I (Critiques)</h4>
        <ul>
          <li>OS, antivirus, VPN, gestionnaires mots de passe</li>
          <li><strong>Certification tierce obligatoire</strong></li>
        </ul>
        <h4>üî¥ Si Classe II (Industrie Critique)</h4>
        <ul>
          <li>Syst√®mes industriels, SCADA, firewalls</li>
          <li><strong>Certification tierce obligatoire</strong></li>
        </ul>
        <div class="obligations-highlight">
          <strong>‚úÖ Exemption :</strong> SaaS pur sans composant t√©l√©charg√©/install√© c√¥t√© client.
        </div>
        <h4>‚ö†Ô∏è Sanctions</h4>
        <ul>
          <li>Jusqu'√† 15M‚Ç¨ ou 2.5% CA</li>
          <li>Retrait march√© possible</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal DSP3 / PSR -->
  <div class="obligations-modal" id="modal-dsp3">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - DSP3 / PSR (2027 Est.)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-dsp3')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour Fintech & PSP</h4>
        <ul>
          <li><strong>V√©rification IBAN/Nom</strong> b√©n√©ficiaire obligatoire (lutte fraude)</li>
          <li><strong>Support paiements instantan√©s</strong> paneurop√©ens</li>
          <li><strong>APIs Open Banking renforc√©es</strong> : acc√®s temps r√©el donn√©es bancaires</li>
        </ul>
        <h4>üè¶ Pour Banques</h4>
        <ul>
          <li><strong>APIs standardis√©es gratuites</strong> pour PSP tiers</li>
          <li><strong>Dashboards unifi√©s</strong> multi-comptes</li>
          <li><strong>Initiation paiement facilit√©e</strong> via API</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üåç Impact :</strong> SaaS √©trangers avec clients FR concern√©s par v√©rification IBAN/Nom.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal EHDS -->
  <div class="obligations-modal" id="modal-ehds">
    <div class="obligations-modal-content">
      <div class="obligations-modal-header">
        <h3>üìã Mes obligations - EHDS / Sant√© (2028 Est.)</h3>
        <button class="obligations-modal-close" onclick="closeObligationsModal('modal-ehds')">√ó</button>
      </div>
      <div class="obligations-modal-body">
        <h4>‚úÖ Pour √âditeurs Logiciels Sant√©</h4>
        <ul>
          <li><strong>Interop√©rabilit√© format EEHRxF</strong> (European Electronic Health Record)</li>
          <li><strong>Export r√©sum√© patient</strong> standardis√© transfrontalier</li>
          <li><strong>e-Prescription europ√©enne</strong> compatible</li>
          <li><strong>Consentement patient centralis√©</strong> : gestion droits acc√®s unifi√©</li>
        </ul>
        <h4>üè• Logiciels Concern√©s</h4>
        <ul>
          <li>DPI (Dossiers Patients Informatis√©s)</li>
          <li>Logiciels imagerie m√©dicale (PACS)</li>
          <li>Laboratoires (LIS)</li>
          <li>Pharmacie (e-prescription)</li>
        </ul>
        <div class="obligations-highlight">
          <strong>üéØ Pilotes 2026 :</strong> Tests nationaux avant g√©n√©ralisation 2028.
        </div>
        <h4>üî¨ Usage Secondaire (Recherche)</h4>
        <ul>
          <li>Acc√®s donn√©es pseudonymis√©es pour recherche</li>
          <li>Consentement opt-in requis</li>
        </ul>
      </div>
    </div>
  </div>

</div>

<div class="footer">
  <p><strong>Version Q4 2025</strong> - Derni√®re mise √† jour : D√©cembre 2025</p>
  <p>Cette frise synth√©tise les principales r√©glementations europ√©ennes et fran√ßaises applicables aux √©diteurs de logiciels, SaaS, plateformes et prestataires IT.</p>
  <p>‚ö†Ô∏è Document √† vocation informative - Consulter les textes officiels pour application juridique.</p>
  <p style="margin-top: 15px; font-size: 0.8rem;">Sources : EUR-Lex, L√©gifrance, CNIL, ANSSI, Commission Europ√©enne</p>
</div>

<script>
// Calcul de la position du marqueur de date actuelle
document.addEventListener('DOMContentLoaded', function() {
  const today = new Date();
  const containers = document.querySelectorAll('.container');
  
  // Fonction pour parser les dates des badges
  function parseDate(dateText) {
    const months = {
      'Jan': 0, 'F√©v': 1, 'Fev': 1, 'Mars': 2, 'Avr': 3, 'Mai': 4, 'Juin': 5,
      'Juil': 6, 'Ao√ªt': 7, 'Aout': 7, 'Sept': 8, 'Oct': 9, 'Nov': 10, 'D√©c': 11, 'Dec': 11
    };
    
    // Gestion "Fin 2025 (Est.)" -> d√©cembre de l'ann√©e
    if (dateText.match(/Fin\s+(\d{4})/i)) {
      const yearMatch = dateText.match(/(\d{4})/);
      return new Date(parseInt(yearMatch[1]), 11, 31); // 31 d√©cembre
    }
    
    // Gestion des formats: "25 Mai 2018", "1 Jan 2021", "D√©c 2027"
    const match = dateText.match(/(\d+)?\s*([A-Za-z√©√ª]+)\s*(\d{4})/);
    if (match) {
      const day = match[1] ? parseInt(match[1]) : 1;
      const month = months[match[2]] !== undefined ? months[match[2]] : 0;
      const year = parseInt(match[3]);
      return new Date(year, month, day);
    }
    
    // Fallback pour dates approximatives avec ann√©e seule
    const yearMatch = dateText.match(/(\d{4})/);
    if (yearMatch) {
      return new Date(parseInt(yearMatch[1]), 6, 1); // Mi-ann√©e par d√©faut
    }
    
    return null;
  }
  
  // Trouver le conteneur le plus proche de la date actuelle
  let closestContainer = null;
  let closestPast = null;
  let closestFuture = null;
  let minPastDiff = Infinity;
  let minFutureDiff = Infinity;
  
  containers.forEach(container => {
    const dateBadge = container.querySelector('.date-badge');
    if (dateBadge) {
      const eventDate = parseDate(dateBadge.textContent);
      if (eventDate) {
        const diff = eventDate - today;
        
        if (diff <= 0) {
          // √âv√©nement pass√© ou actuel
          const absDiff = Math.abs(diff);
          if (absDiff < minPastDiff) {
            minPastDiff = absDiff;
            closestPast = container;
          }
        } else {
          // √âv√©nement futur
          if (diff < minFutureDiff) {
            minFutureDiff = diff;
            closestFuture = container;
          }
        }
      }
    }
  });
  
  // Prioriser l'√©v√©nement futur le plus proche, sinon prendre le pass√© le plus r√©cent
  closestContainer = closestFuture || closestPast;
  
  // Placer le marqueur et scroller
  let currentMarker = null;
  let isAllPast = false;
  
  if (closestContainer) {
    const marker = document.createElement('div');
    marker.className = 'current-date-marker';
    marker.textContent = 'AUJOURD\'HUI';
    marker.id = 'todayMarker';
    
    // Si tous les √©v√©nements sont pass√©s, placer le marqueur en bas
    if (!closestFuture && closestPast) {
      isAllPast = true;
      marker.classList.add('bottom-marker');
    } else {
      marker.style.top = (closestContainer.offsetTop - 50) + 'px';
    }
    
    document.querySelector('.timeline').appendChild(marker);
    currentMarker = marker;
    
    // Scroll automatique vers le marqueur avec un d√©lai pour permettre le rendu
    setTimeout(() => {
      if (!isAllPast) {
        marker.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }, 100);
  }

  // Fonction pour repositionner le marqueur selon les offsets actuels
  function updateMarkerPosition() {
    if (currentMarker && closestContainer) {
      currentMarker.style.top = (closestContainer.offsetTop - 50) + 'px';
    }
  }

  // Bouton retour √† aujourd'hui
  const backToTodayBtn = document.getElementById('backToToday');
  if (backToTodayBtn && currentMarker) {
    backToTodayBtn.addEventListener('click', function() {
      currentMarker.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
  }

  // Recalculer la position du marqueur lors du redimensionnement
  let resizeTimeout;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(function() {
      updateMarkerPosition();
      const tocContainer = document.getElementById('tocContainer');
      if (window.innerWidth > 768) {
        document.body.classList.remove('toc-open');
      } else if (tocContainer && !tocContainer.classList.contains('collapsed')) {
        document.body.classList.add('toc-open');
      }
    }, 100);
  });

  // === SYST√àME DE FILTRAGE ===
  const legendContainer = document.getElementById('legendContainer');
  const legendToggle = document.getElementById('legendToggle');
  const legendItems = document.querySelectorAll('.legend-item');

  // Toggle panneau filtres en mobile
  if (legendToggle) {
    legendToggle.addEventListener('click', function() {
      legendContainer.classList.toggle('expanded');
    });
  }

  // √âtat des filtres (tous actifs par d√©faut)
  const filterState = {
    universal: true,
    b2b: true,
    b2c: true,
    iot: true,
    regulated: true,
    esn: false
  };

  // Compter les √©l√©ments par cat√©gorie
  function updateCounts() {
    const counts = {
      universal: 0,
      b2b: 0,
      b2c: 0,
      iot: 0,
      regulated: 0,
      esn: 0
    };

    containers.forEach(container => {
      const content = container.querySelector('.content');
      if (content.classList.contains('card-universal')) counts.universal++;
      if (content.classList.contains('card-b2b')) counts.b2b++;
      if (content.classList.contains('card-b2c')) counts.b2c++;
      if (content.classList.contains('card-iot')) counts.iot++;
      if (content.classList.contains('card-regulated')) counts.regulated++;
      if (content.classList.contains('card-esn')) counts.esn++;
    });

    // Mettre √† jour l'affichage
    Object.keys(counts).forEach(category => {
      const countElement = document.getElementById(`count-${category}`);
      if (countElement) {
        countElement.textContent = counts[category];
      }
    });
  }

  // R√©organiser les conteneurs visibles en quinconce
  function reorderContainers() {
    const visibleContainers = Array.from(containers).filter(c => !c.classList.contains('hidden'));
    
    visibleContainers.forEach((container, index) => {
      // Alterner gauche/droite selon l'index
      if (index % 2 === 0) {
        container.classList.remove('right');
        container.classList.add('left');
      } else {
        container.classList.remove('left');
        container.classList.add('right');
      }
      
      // Le premier visible ne doit pas avoir de margin n√©gatif
      if (index === 0) {
        container.style.marginTop = '0';
      } else {
        container.style.marginTop = '';
      }
    });
  }

  // Repositionner le marqueur "Aujourd'hui"
  function repositionTodayMarker() {
    if (!currentMarker) return;
    
    // Recalculer la position en fonction des conteneurs visibles
    const visibleContainers = Array.from(containers).filter(c => !c.classList.contains('hidden'));
    if (visibleContainers.length === 0) return;
    
    // Trouver le conteneur visible le plus proche de la date actuelle
    let newClosestPast = null;
    let newClosestFuture = null;
    let minPastDiff = Infinity;
    let minFutureDiff = Infinity;
    
    visibleContainers.forEach(container => {
      const dateBadge = container.querySelector('.date-badge');
      if (dateBadge) {
        const eventDate = parseDate(dateBadge.textContent);
        if (eventDate) {
          const diff = eventDate - today;
          
          if (diff <= 0) {
            // √âv√©nement pass√©
            const absDiff = Math.abs(diff);
            if (absDiff < minPastDiff) {
              minPastDiff = absDiff;
              newClosestPast = container;
            }
          } else {
            // √âv√©nement futur
            if (diff < minFutureDiff) {
              minFutureDiff = diff;
              newClosestFuture = container;
            }
          }
        }
      }
    });
    
    // Prioriser l'√©v√©nement futur le plus proche
    const newClosest = newClosestFuture || newClosestPast;
    if (newClosest) {
      closestContainer = newClosest;
      // Attendre que le DOM soit mis √† jour avant de repositionner
      setTimeout(() => {
        // Si tous les √©v√©nements visibles sont pass√©s, placer en bas
        if (!newClosestFuture && newClosestPast) {
          currentMarker.classList.add('bottom-marker');
          currentMarker.style.top = '';
        } else {
          currentMarker.classList.remove('bottom-marker');
          currentMarker.style.top = (closestContainer.offsetTop - 50) + 'px';
        }
      }, 50);
    }
  }

  // Appliquer les filtres
  function applyFilters() {
    containers.forEach(container => {
      const content = container.querySelector('.content');
      let shouldShow = false;

      // V√©rifier si le conteneur correspond √† au moins une cat√©gorie active
      if (filterState.universal && content.classList.contains('card-universal')) shouldShow = true;
      if (filterState.b2b && content.classList.contains('card-b2b')) shouldShow = true;
      if (filterState.b2c && content.classList.contains('card-b2c')) shouldShow = true;
      if (filterState.iot && content.classList.contains('card-iot')) shouldShow = true;
      if (filterState.regulated && content.classList.contains('card-regulated')) shouldShow = true;
      if (filterState.esn && content.classList.contains('card-esn')) shouldShow = true;

      // Appliquer le masquage
      if (shouldShow) {
        container.classList.remove('hidden');
      } else {
        container.classList.add('hidden');
      }
    });

    // R√©organiser l'alternance apr√®s filtrage
    reorderContainers();
    
    // Repositionner le marqueur "Aujourd'hui" apr√®s un d√©lai pour laisser le DOM se stabiliser
    setTimeout(() => {
      repositionTodayMarker();
    }, 100);
  }

  // Gestion des clics sur les items de l√©gende (filtres)
  legendItems.forEach(item => {
    const category = item.dataset.category;
    if (!category) return; // Ignorer le titre
    
    item.addEventListener('click', function() {
      filterState[category] = !filterState[category];

      // Mettre √† jour l'apparence de l'item
      if (filterState[category]) {
        this.classList.remove('inactive');
        this.classList.add('active');
      } else {
        this.classList.remove('active');
        this.classList.add('inactive');
      }

      applyFilters();
      updateEsnInfoVisibility();
    });
  });

  // Fonction pour afficher/masquer les infos ESN
  function updateEsnInfoVisibility() {
    const esnInfoTags = document.querySelectorAll('.esn-info');
    esnInfoTags.forEach(tag => {
      if (filterState.esn) {
        tag.classList.remove('hidden');
      } else {
        tag.classList.add('hidden');
      }
    });
  }

  // Initialiser la visibilit√© des infos ESN
  updateEsnInfoVisibility();

  // Initialisation
  updateCounts();

  // Repositionner correctement le marqueur apr√®s initialisation des filtres
  setTimeout(() => {
    if (currentMarker && closestContainer) {
      currentMarker.style.top = (closestContainer.offsetTop - 50) + 'px';
    }
  }, 200);

  // === SOMMAIRE FLOTTANT ===
  const tocContainer = document.getElementById('tocContainer');
  const tocHeader = document.getElementById('tocHeader');
  const tocContent = document.getElementById('tocContent');

  // G√©n√©rer le sommaire
  function generateTOC() {
    tocContent.innerHTML = '';
    
    containers.forEach((container, index) => {
      // Ignorer les conteneurs masqu√©s
      if (container.classList.contains('hidden')) return;
      
      const dateBadge = container.querySelector('.date-badge');
      const title = container.querySelector('h2');
      
      if (dateBadge && title) {
        const tocItem = document.createElement('a');
        tocItem.className = 'toc-item';
        tocItem.dataset.index = index;
        
        const dateSpan = document.createElement('span');
        dateSpan.className = 'toc-item-date';
        dateSpan.textContent = dateBadge.textContent;
        
        const titleSpan = document.createElement('span');
        titleSpan.className = 'toc-item-title';
        titleSpan.textContent = title.textContent;
        
        tocItem.appendChild(dateSpan);
        tocItem.appendChild(titleSpan);
        
        // Clic pour scroller vers l'√©l√©ment
        tocItem.addEventListener('click', function() {
          container.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
          // Marquer l'√©l√©ment actif
          document.querySelectorAll('.toc-item').forEach(item => item.classList.remove('active'));
          tocItem.classList.add('active');
        });
        
        tocContent.appendChild(tocItem);
      }
    });
  }

  // Toggle du sommaire via l'en-t√™te
  tocHeader.addEventListener('click', function() {
    tocContainer.classList.toggle('collapsed');
    if (window.innerWidth <= 768) {
      document.body.classList.toggle('toc-open', !tocContainer.classList.contains('collapsed'));
    }
  });

  // R√©g√©n√©rer le sommaire initial
  generateTOC();

  // Mettre √† jour le sommaire lors du filtrage
  const originalApplyFilters = applyFilters;
  applyFilters = function() {
    originalApplyFilters();
    generateTOC();
  };

  // === GESTION DES POPUPS OBLIGATIONS ===
  function openObligationsModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Bloquer le scroll
    }
  }

  function closeObligationsModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove('show');
      document.body.style.overflow = ''; // Restaurer le scroll
    }
  }

  // Fermer la popup en cliquant sur le fond
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('obligations-modal')) {
      e.target.classList.remove('show');
      document.body.style.overflow = '';
    }
  });

  // Fermer avec la touche Escape
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      const openModal = document.querySelector('.obligations-modal.show');
      if (openModal) {
        openModal.classList.remove('show');
        document.body.style.overflow = '';
      }
    }
  });

  // Exposer les fonctions globalement pour les boutons
  window.openObligationsModal = openObligationsModal;
  window.closeObligationsModal = closeObligationsModal;
});
</script>

</body>
</html>