<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frise Chronologique R√©glementaire - Prestataires Logiciels</title>
<style>
  /* --- RESET ET POLICES --- */
  * { box-sizing: border-box; }
  body {
    background-color: #f4f7f6;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #333;
    margin: 0;
    padding: 20px;
  }

  h1 { text-align: center; color: #2c3e50; margin-bottom: 5px; }
  p.subtitle { text-align: center; font-style: italic; margin-bottom: 20px; color: #7f8c8d; }

  /* --- COULEURS CIBLES (Categories) --- */
  /* Universel : Tout logiciel, ESN, Dev */
 .theme-universal { --main-color: #34495e; --bg-light: #eaeded; } 
  /* B2B & Cloud : SaaS, ERP, H√©bergement */
 .theme-b2b { --main-color: #2980b9; --bg-light: #d6eaf8; }
  /* B2C & Plateformes : Apps, Marketplaces, E-commerce */
 .theme-b2c { --main-color: #8e44ad; --bg-light: #ebdef0; }
  /* Industrie & IoT : Logiciels embarqu√©s, Hardware */
 .theme-iot { --main-color: #27ae60; --bg-light: #d5f5e3; }
  /* Secteurs R√©gul√©s : Banque, Sant√©, Public */
 .theme-regulated { --main-color: #c0392b; --bg-light: #fadbd8; }

  /* --- L√âGENDE / PANNEAU DE FILTRAGE FLOTTANT --- */
 .legend-container {
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1001;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 10px;
    padding: 12px 20px;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    border-bottom: 2px solid #ecf0f1;
    transition: all 0.3s ease;
    overflow: visible;
  }

 .legend-title {
    font-weight: bold;
    margin: 0 15px 0 0;
    color: #2c3e50;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 1px;
    white-space: nowrap;
    cursor: default;
  }
  
 .legend-toggle-btn {
    display: none;
  }

 .legend-items-wrapper {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
    justify-content: center;
  }

 .legend-item {
    display: flex;
    align-items: center;
    font-size: 0.8rem;
    font-weight: 600;
    padding: 8px 14px;
    border-radius: 20px;
    border: 2px solid;
    transition: all 0.2s;
    cursor: pointer;
    user-select: none;
  }
  
 .legend-item:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  }
  
 .legend-item.active {
    opacity: 1;
  }
  
 .legend-item.inactive {
    opacity: 0.35;
    background: #f8f9fa;
    filter: grayscale(50%);
  }

 .dot {
    height: 12px;
    width: 12px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 8px;
    flex-shrink: 0; /* Emp√™che l'√©crasement du cercle */
  }

  /* Application des couleurs l√©gende */
 .leg-universal { background-color: #eaeded; color: #34495e; border-color: #34495e; }
 .leg-universal.dot { background-color: #34495e; }
 .leg-universal.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-b2b { background-color: #d6eaf8; color: #2980b9; border-color: #2980b9; }
 .leg-b2b.dot { background-color: #2980b9; }
 .leg-b2b.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-b2c { background-color: #ebdef0; color: #8e44ad; border-color: #8e44ad; }
 .leg-b2c.dot { background-color: #8e44ad; }
 .leg-b2c.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-iot { background-color: #d5f5e3; color: #27ae60; border-color: #27ae60; }
 .leg-iot.dot { background-color: #27ae60; }
 .leg-iot.inactive { border-color: #bdc3c7; color: #7f8c8d; }

 .leg-regulated { background-color: #fadbd8; color: #c0392b; border-color: #c0392b; }
 .leg-regulated.dot { background-color: #c0392b; }
 .leg-regulated.inactive { border-color: #bdc3c7; color: #7f8c8d; }
 
 /* Compteur sur les items de l√©gende */
 .legend-count {
    margin-left: 6px;
    font-size: 0.75rem;
    padding: 2px 6px;
    border-radius: 10px;
    background: rgba(0,0,0,0.15);
    font-weight: bold;
  }

  /* --- TIMELINE --- */
 .timeline {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
    margin-top: 20px; /* R√©duit car le panneau n'est plus fixe en haut */
  }

  /* Ligne verticale */
 .timeline::after {
    content: '';
    position: absolute;
    width: 4px;
    background-color: #bdc3c7;
    top: 0;
    bottom: 0;
    left: 50%;
    margin-left: -2px;
    border-radius: 2px;
  }

  /* Conteneur */
 .container {
    padding: 10px 40px;
    position: relative;
    background-color: inherit;
    width: 50%;
  }

  /* Cercles sur la ligne */
 .container::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    right: -8px;
    background-color: white;
    border: 3px solid #bdc3c7;
    top: 24px; /* Ajust√© pour aligner avec le header */
    border-radius: 50%;
    z-index: 1;
  }

  /* Gauche / Droite */
 .left { left: 0; }
 .right { left: 50%; }
 .left::before {
    content: " ";
    height: 0;
    position: absolute;
    top: 26px;
    width: 0;
    z-index: 1;
    right: 30px;
    border: medium solid white;
    border-width: 10px 0 10px 10px;
    border-color: transparent transparent transparent white;
  }
 .right::before {
    content: " ";
    height: 0;
    position: absolute;
    top: 26px;
    width: 0;
    z-index: 1;
    left: 30px;
    border: medium solid white;
    border-width: 10px 10px 10px 0;
    border-color: transparent white transparent transparent;
  }
 .right::after { left: -8px; }

  /* Carte de contenu */
 .content {
    padding: 20px 25px;
    background-color: white;
    position: relative;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    border-left: 6px solid #ccc; /* Couleur par d√©faut */
  }

  /* --- STYLES INTERNES CARTE --- */
 .header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }

 .date-badge {
    background-color: #555;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: bold;
  }

 .origin-badge {
    font-size: 0.75rem;
    padding: 2px 6px;
    border-radius: 4px;
    text-transform: uppercase;
    font-weight: 800;
    border: 1px solid #ddd;
  }
 .origin-eu { color: #003399; background-color: #e6f0ff; border-color: #003399; } /* Bleu Europe */
 .origin-fr { color: #002395; background-color: #f0f0f0; border-color: #ed2939; } /* Bleu/Rouge France */

  h2 { margin: 0 0 5px 0; font-size: 1.1rem; color: #333; }
  
 .target-tag {
    display: inline-block;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    margin-bottom: 8px;
    padding: 2px 0;
    color: var(--main-color, #555);
  }

  p { margin: 5px 0 0; line-height: 1.4; font-size: 0.9rem; color: #555; }

  /* Liens r√©glementaires */
 .reg-link {
    display: inline-block;
    margin-top: 8px;
    font-size: 0.8rem;
    color: #3498db;
    text-decoration: none;
    font-weight: 600;
    transition: color 0.2s;
  }
 .reg-link:hover {
    color: #2980b9;
    text-decoration: underline;
  }

  /* Marqueur date actuelle */
 .current-date-marker {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 30px;
    background-color: #e74c3c;
    color: white;
    text-align: center;
    line-height: 30px;
    font-weight: bold;
    font-size: 0.8rem;
    border-radius: 4px;
    z-index: 10;
    box-shadow: 0 2px 10px rgba(231, 76, 60, 0.4);
  }
 .current-date-marker::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid #e74c3c;
  }

  /* Bouton retour √† aujourd'hui */
 .back-to-today {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #e74c3c;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 50px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.85rem;
    z-index: 1000;
    box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }
 .back-to-today:hover {
    background: #c0392b;
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
  }
 .back-to-today:active {
    transform: translateY(0);
  }

  /* --- SOMMAIRE FLOTTANT --- */
 .toc-container {
    position: sticky;
    top: 70px;
    right: 20px;
    width: 280px;
    max-height: calc(100vh - 150px);
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    z-index: 998;
    transition: all 0.3s ease;
    overflow: hidden;
    float: right;
    margin-top: 20px;
    margin-right: 20px;
    margin-left: 20px;
  }
 .toc-container.collapsed {
    width: auto;
    max-height: 50px;
    box-shadow: -4px 4px 12px rgba(0,0,0,0.2);
  }
 .toc-container.collapsed .toc-content {
    display: none;
  }
 .toc-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 18px;
    background: #2c3e50;
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
  }
 .toc-header:hover {
    background: #34495e;
  }
 .toc-container.collapsed .toc-header {
    border-radius: 12px 0 0 12px;
  }
 .toc-title {
    font-weight: bold;
    color: white;
    font-size: 0.9rem;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 8px;
  }
 .toc-toggle-icon {
    font-size: 1rem;
    transition: transform 0.3s ease;
  }
 .toc-container.collapsed .toc-toggle-icon {
    transform: rotate(180deg);
  }
 .toc-content {
    padding: 15px 10px;
    max-height: calc(100vh - 260px);
    overflow-y: auto;
    background: white;
  }
 .toc-item {
    display: block;
    padding: 8px 15px;
    margin: 3px 0;
    font-size: 0.8rem;
    color: #34495e;
    text-decoration: none;
    border-radius: 6px;
    border-left: 3px solid transparent;
    transition: all 0.2s;
    cursor: pointer;
  }
 .toc-item:hover {
    background: #ecf0f1;
    border-left-color: #3498db;
    transform: translateX(3px);
  }
 .toc-item-date {
    font-weight: bold;
    color: #7f8c8d;
    font-size: 0.7rem;
    display: block;
    margin-bottom: 2px;
  }
 .toc-item-title {
    display: block;
    font-weight: 600;
  }
 .toc-item.active {
    background: #d6eaf8;
    border-left-color: #2980b9;
  }

  /* Animation de masquage des conteneurs filtr√©s */
 .container.hidden {
    display: none;
  }

  /* --- APPLICATION DES TH√àMES AUX CARTES --- */
 .card-universal { border-left-color: #34495e; }
 .card-universal.date-badge { background-color: #34495e; }
 .card-universal.target-tag { color: #34495e; }

 .card-b2b { border-left-color: #2980b9; }
 .card-b2b.date-badge { background-color: #2980b9; }
 .card-b2b.target-tag { color: #2980b9; }

 .card-b2c { border-left-color: #8e44ad; }
 .card-b2c.date-badge { background-color: #8e44ad; }
 .card-b2c.target-tag { color: #8e44ad; }

 .card-iot { border-left-color: #27ae60; }
 .card-iot.date-badge { background-color: #27ae60; }
 .card-iot.target-tag { color: #27ae60; }

 .card-regulated { border-left-color: #c0392b; }
 .card-regulated.date-badge { background-color: #c0392b; }
 .card-regulated.target-tag { color: #c0392b; }

  /* Footer */
 .footer {
    text-align: center;
    padding: 40px 20px;
    margin-top: 60px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
  }
 .footer p {
    margin: 5px 0;
    color: #7f8c8d;
    font-size: 0.9rem;
  }
 .footer strong {
    color: #2c3e50;
  }

  /* --- RESPONSIVE --- */
  @media screen and (max-width: 768px) {
   .timeline::after { left: 31px; }
   .container { width: 100%; padding-left: 70px; padding-right: 25px; }
   .container::before { left: 60px; border: medium solid white; border-width: 10px 10px 10px 0; border-color: transparent white transparent transparent; }
   .left::after,.right::after { left: 21px; }
   .right { left: 0%; }
   .legend-container { 
     flex-direction: column; 
     align-items: stretch;
     padding: 0;
     gap: 0;
     max-height: 50px;
   }
   .legend-container.expanded {
     max-height: 300px;
   }
   .legend-toggle-btn {
     display: block;
     width: 100%;
     padding: 12px;
     background: #2c3e50;
     color: white;
     border: none;
     font-weight: bold;
     font-size: 0.85rem;
     cursor: pointer;
     text-align: center;
   }
   .legend-toggle-btn:active {
     background: #34495e;
   }
   .legend-title {
     display: none;
   }
   .legend-items-wrapper {
     padding: 8px 10px;
     display: none;
     flex-direction: column;
     gap: 6px;
   }
   .legend-container.expanded .legend-items-wrapper {
     display: flex;
   }
   .toc-container {
     display: block !important;
   }
   .legend-item {
     font-size: 0.7rem;
     padding: 6px 8px;
     width: 100%;
     justify-content: space-between;
   }
   .legend-item .dot {
     margin-right: 6px;
   }
   .legend-count {
     margin-left: auto;
   }
   .timeline { margin-top: 80px; }
   .current-date-marker { 
     width: 85px; 
     font-size: 0.65rem;
     left: -11px;
     transform: none;
   }
   .current-date-marker::after {
     left: 35px;
     transform: none;
   }
   .back-to-today {
     position: fixed;
     bottom: 80px;
     right: 15px;
     left: 15px;
     padding: 10px 14px;
     font-size: 0.8rem;
     justify-content: center;
     transition: bottom 0.3s ease;
     z-index: 999;
   }
   .timeline { margin-top: 200px; }
   .toc-container {
     position: fixed;
     width: calc(100% - 30px);
     right: 15px;
     left: 15px;
     top: auto;
     bottom: 20px;
     max-height: 50px;
     border-radius: 12px;
     box-shadow: 0 -4px 20px rgba(0,0,0,0.2);
     transition: max-height 0.3s ease, bottom 0.3s ease;
     z-index: 998;
     overflow: hidden;
     float: none;
     margin: 0;
   }
   .toc-container:not(.collapsed) {
     max-height: 50vh;
   }
   .toc-container.collapsed {
     max-height: 50px;
   }
   .toc-container.collapsed .toc-header {
     border-radius: 12px;
   }
   .toc-toggle-icon {
     transform: rotate(180deg);
   }
   .toc-container.collapsed .toc-toggle-icon {
     transform: rotate(0deg);
   }
   body.toc-open .back-to-today {
     bottom: calc(50vh + 30px);
   }
   body.toc-open .toc-container {
     bottom: 20px;
   }
   
   /* Panneau de filtrage en mobile */
   .filter-panel {
     top: 10px;
     right: 10px;
     left: 10px;
     max-width: none;
     padding: 15px;
   }
   .filter-toggle {
     top: 10px;
     right: 10px;
     padding: 10px 14px;
     font-size: 0.85rem;
   }
   .filter-btn {
     font-size: 0.8rem;
     padding: 8px 12px;
   }
   .filter-panel-title {
     font-size: 0.9rem;
   }
  }
</style>
</head>
<body>

<h1>√âch√©ances R√©glementaires : Logiciels & SaaS</h1>
<p class="subtitle">Vue synth√©tique par type d'acteur concern√© (2016 - 2030+) | <strong>Version Q4 2025</strong></p>

<!-- Panneau de filtrage flottant (ancienne l√©gende transform√©e) -->
<div class="legend-container" id="legendContainer">
  <button class="legend-toggle-btn" id="legendToggle">üîç Filtrer par cat√©gorie</button>
  <div class="legend-title">Qui est concern√© ?</div>
  <div class="legend-items-wrapper">
    <div class="legend-item leg-universal active" data-category="universal">
      <span class="dot"></span>Universel (Tout Logiciel / Tout Site)
      <span class="legend-count" id="count-universal">0</span>
    </div>
    <div class="legend-item leg-b2b active" data-category="b2b">
      <span class="dot"></span>SaaS B2B, Cloud & Gestion
      <span class="legend-count" id="count-b2b">0</span>
    </div>
    <div class="legend-item leg-b2c active" data-category="b2c">
      <span class="dot"></span>Plateformes, Apps B2C & Marketplaces
      <span class="legend-count" id="count-b2c">0</span>
    </div>
    <div class="legend-item leg-iot active" data-category="iot">
      <span class="dot"></span>IoT, Industrie & Mat√©riel
      <span class="legend-count" id="count-iot">0</span>
    </div>
    <div class="legend-item leg-regulated active" data-category="regulated">
      <span class="dot"></span>Secteurs R√©gul√©s (Finance, Sant√©, Public)
      <span class="legend-count" id="count-regulated">0</span>
    </div>
  </div>
</div>

<!-- Bouton retour √† aujourd'hui -->
<button class="back-to-today" id="backToToday">
  üìÖ Aujourd'hui
</button>

<!-- Sommaire flottant -->
<div class="toc-container collapsed" id="tocContainer">
  <div class="toc-header" id="tocHeader">
    <h3 class="toc-title">
      üìã Sommaire
      <span class="toc-toggle-icon">‚óÄ</span>
    </h3>
  </div>
  <div class="toc-content" id="tocContent">
    <!-- G√©n√©r√© dynamiquement par JavaScript -->
  </div>
</div>

<div class="timeline">

  <div class="container right">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">25 Mai 2018</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>RGPD (R√®glement G√©n√©ral sur la Protection des Donn√©es)</h2>
      <span class="target-tag">Cible : Tout Logiciel / Tout Traitement de Donn√©es</span>
      <p>Protection des donn√©es personnelles : privacy by design et by default, droit √† l'oubli, portabilit√© des donn√©es. Sanctions jusqu'√† 20M‚Ç¨ ou 4% du CA mondial annuel. 6 bases l√©gales exclusives : consentement explicite (opt-in r√©vocable), ex√©cution contrat, obligation l√©gale, sauvegarde int√©r√™ts vitaux, mission int√©r√™t public, int√©r√™t l√©gitime (balanc√© avec droits utilisateur). DPO obligatoire si traitement grande √©chelle ou donn√©es sensibles. Registre traitements obligatoire. Notification violations CNIL sous 72h. AIPD obligatoire si risque √©lev√©.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2016/679/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2016/679</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">25 Mai 2018</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>ePrivacy (Directive Cookie)</h2>
      <span class="target-tag">Cible : Tous Sites Web & Apps</span>
      <p>Consentement explicite requis avant tout cookie non essentiel (marketing, analytics, publicit√©). Bandeau cookie obligatoire avec refus aussi facile qu'acceptation (m√™me nombre de clics). Interdiction des "cookie walls" abusifs (bloquer l'acc√®s sans consentement). En France, appliqu√© strictement par la CNIL depuis 2020 (lignes directrices). Dur√©e conservation consentement : 13 mois max. Preuve consentement obligatoire (logs horodat√©s).</p>
      <a href="https://eur-lex.europa.eu/legal-content/FR/TXT/?uri=CELEX%3A32002L0058" target="_blank" class="reg-link">üìÑ Directive 2002/58/CE</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">1 Jan 2020</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi Anti-Fraude TVA (Certification Caisse)</h2>
      <span class="target-tag">Cible : Logiciels de Caisse & Encaissement</span>
      <p>Obligation de certification NF 525 pour tout logiciel de caisse ou syst√®me d'encaissement. Conditions : inalt√©rabilit√©, s√©curisation, conservation et archivage des donn√©es. Attestation obligatoire √† pr√©senter en cas de contr√¥le fiscal. Sanctions : amende 7500‚Ç¨ par logiciel non conforme. Concerne points de vente, e-commerce avec caisse int√©gr√©e, apps mobiles encaissement.</p>
      <a href="https://www.legifrance.gouv.fr/eli/loi/2015/12/29/2015-1785/jo/texte" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2015-1785 (Art. 88)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">12 Juil 2020</span>
        <span class="origin-badge origin-eu">Europe (Arr√™t)</span>
      </div>
      <h2>Schrems II (Transferts UE-USA)</h2>
      <span class="target-tag">Cible : SaaS utilisant h√©bergeurs US</span>
      <p>Invalidation du Privacy Shield. Transferts de donn√©es hors UE n√©cessitent clauses contractuelles types (CCT) et analyse d'impact obligatoire (TIA - Transfer Impact Assessment). Risque accru avec h√©bergeurs soumis au CLOUD Act (AWS, Azure, GCP). Obligation d'√©valuer les lois du pays tiers (surveillance gouvernementale). Mesures suppl√©mentaires requises : chiffrement bout-en-bout, cl√©s gestion UE, pseudonymisation. Solutions √©mergentes : Data Clean Rooms, Confidential Computing (enclaves s√©curis√©es). Alternative : h√©bergement 100% UE souverain.</p>
      <a href="https://curia.europa.eu/juris/document/document.jsf?docid=228677" target="_blank" class="reg-link">üìÑ Arr√™t C-311/18</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">24 Nov 2020</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Accessibilit√© Num√©rique (RGAA)</h2>
      <span class="target-tag">Cible : Sites publics & grandes entreprises</span>
      <p>Obligation de conformit√© RGAA (R√©f√©rentiel G√©n√©ral d'Am√©lioration de l'Accessibilit√©) pour les sites web et applications mobiles des organismes publics et entreprises >250M‚Ç¨ CA. Niveau minimum : AA (WCAG 2.1). D√©claration d'accessibilit√© obligatoire. Sch√©ma pluriannuel de mise en conformit√©. Sanctions : jusqu'√† 20 000‚Ç¨ par site non conforme. Concern√© : lecteurs √©cran, navigation clavier, contraste couleurs, sous-titres vid√©o.</p>
      <a href="https://www.legifrance.gouv.fr/eli/decret/2019/7/24/2019-768/jo/texte" target="_blank" class="reg-link">üìÑ D√©cret n¬∞ 2019-768</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-iot">
      <div class="header-row">
        <span class="date-badge">1 Jan 2021</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi AGEC (Indice de R√©parabilit√©)</h2>
      <span class="target-tag">Cible : OS, Logiciels embarqu√©s</span>
      <p>Le calcul de la r√©parabilit√© des √©quipements inclut d√©sormais la dur√©e de disponibilit√© des mises √† jour logicielles. Impact sur smartphones, tablettes, ordinateurs portables. Obligation d'affichage en magasin et en ligne (note sur 10).</p>
      <a href="https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000041553759" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2020-105 (AGEC)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">1 Jan 2022</span>
        <span class="origin-badge origin-fr">France (Transpo UE)</span>
      </div>
      <h2>Garantie L√©gale de Conformit√© Num√©rique</h2>
      <span class="target-tag">Cible : Editeurs B2C, Jeux, Apps</span>
      <p>Obligation de fournir les mises √† jour n√©cessaires au maintien de la conformit√© pendant 2 ans minimum pour les produits et services num√©riques vendus aux consommateurs. Transposition de la directive europ√©enne sur les contenus et services num√©riques. Le consommateur peut demander r√©paration, remplacement ou remboursement en cas de d√©faut.</p>
      <a href="https://www.legifrance.gouv.fr/jorf/id/JORFTEXT000043884445" target="_blank" class="reg-link">üìÑ Ordonnance n¬∞ 2021-1247</a>
      <a href="https://eur-lex.europa.eu/eli/dir/2019/770/oj" target="_blank" class="reg-link">üìÑ Directive (UE) 2019/770</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">7 Sept 2021</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Directive Copyright (Upload Filters)</h2>
      <span class="target-tag">Cible : Plateformes UGC, R√©seaux Sociaux</span>
      <p>Obligation de filtrage automatique des contenus prot√©g√©s par droits d'auteur upload√©s par utilisateurs (Article 17). Filtres anti-contrefa√ßon obligatoires pour plateformes >5M users. Accords de licence pr√©alables avec ayants-droit requis. Proc√©dure contestation utilisateur obligatoire. Concerne YouTube, TikTok, Dailymotion, plateformes partage vid√©o/musique. Exemptions : startups <3 ans, <10M‚Ç¨ CA.</p>
      <a href="https://eur-lex.europa.eu/eli/dir/2019/790/oj" target="_blank" class="reg-link">üìÑ Directive (UE) 2019/790 (DSM)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">9 Juin 2023</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi Influenceurs</h2>
      <span class="target-tag">Cible : R√©seaux Sociaux, Plateformes</span>
      <p>Obligation technique d'afficher un bouton de signalement des contenus illicites et de traiter prioritairement les notifications des signaleurs de confiance. Encadrement strict de la promotion de certains produits (chirurgie esth√©tique, paris). Interdiction publicit√© pour enfants de moins de 16 ans sans consentement parental.</p>
      <a href="https://www.legifrance.gouv.fr/eli/loi/2023/6/9/2023-451/jo/texte" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2023-451 (Influenceurs)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">20 Sept 2023</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>eIDAS 2.0 (Identit√© Num√©rique)</h2>
      <span class="target-tag">Cible : Tout Service en Ligne, SSO, Auth</span>
      <p>Cr√©ation du Portefeuille Europ√©en d'Identit√© Num√©rique (EUDI Wallet) accessible √† tous les citoyens UE. Obligation pour services publics d'accepter l'authentification via wallet UE. Services priv√©s fortement encourag√©s (adoption volontaire). Permet stockage identit√©, permis, dipl√¥mes, prescriptions m√©dicales. Signature √©lectronique qualifi√©e int√©gr√©e. Impact majeur sur SSO/OAuth : interop√©rabilit√© paneurop√©enne obligatoire.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/1183/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/1183 (eIDAS 2)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">2 Mars 2024</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>DMA (Digital Markets Act)</h2>
      <span class="target-tag">Cible : Gatekeepers (Apple, Google, Meta...)</span>
      <p>Obligation d'interop√©rabilit√© pour les "contr√¥leurs d'acc√®s" (>45M users UE mensuels, >75M‚Ç¨ CA UE). Messageries instantan√©es doivent s'ouvrir (WhatsApp, iMessage). App Stores : autorisation side-loading, stores tiers, moteurs paiement alternatifs. Interdiction auto-pr√©f√©rence (favoriser ses propres services dans classements). Acc√®s aux donn√©es plateforme pour tiers. Portabilit√© donn√©es en temps r√©el. Sanctions : jusqu'√† 10% CA mondial, 20% en r√©cidive.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2022/1925/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2022/1925 (DMA)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2c">
      <div class="header-row">
        <span class="date-badge">17 F√©v 2024</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Digital Services Act (DSA)</h2>
      <span class="target-tag">Cible : Marketplaces, H√©bergeurs</span>
      <p>Syst√®me de "Notice & Action" obligatoire (signalement + retrait contenus illicites). Tra√ßabilit√© des vendeurs pro (KYBC) obligatoire pour les places de march√©. Tr√®s grandes plateformes (>45M users UE) : audit annuel, analyse risques syst√©miques, transparence algorithmes. Point de contact unique UE obligatoire.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2022/2065/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2022/2065 (DSA)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">22 Mai 2024</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Loi SREN</h2>
      <span class="target-tag">Cible : Cloud, Sites Adultes</span>
      <p>Encadrement des cr√©dits cloud (dur√©e limit√©e √† 12 mois, remboursement obligatoire). Obligation de v√©rification d'√¢ge stricte pour les sites pornographiques (double anonymat). Blocage DNS possible ordonn√© par Arcom. Renforcement lutte contre arnaques en ligne et contrefa√ßons. Obligation h√©bergeurs : contact France, repr√©sentant l√©gal UE.</p>
      <a href="https://www.legifrance.gouv.fr/eli/loi/2024/5/21/2024-449/jo/texte" target="_blank" class="reg-link">üìÑ Loi n¬∞ 2024-449 (SREN)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">17 Jan 2025</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>DORA (Entr√©e en vigueur)</h2>
      <span class="target-tag">Cible : Fintech, SaaS Bancaire</span>
      <p>Contrats de r√©silience informatique obligatoires avec les clients financiers. Surveillance directe des prestataires TIC critiques par l'UE (ESA). Tests de r√©silience obligatoires (TLPT - Threat-Led Penetration Testing tous les 3 ans). Notification incidents sous 4h (initial) puis rapports d√©taill√©s. Registre des risques TIC. Due diligence fournisseurs renforc√©e. En France : qualification SecNumCloud ANSSI ou √©quivalent fortement recommand√©e pour h√©bergeurs de donn√©es financi√®res sensibles.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2022/2554/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2022/2554 (DORA)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">2 F√©v 2025</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>AI Act (Interdictions)</h2>
      <span class="target-tag">Cible : Tous D√©veloppeurs IA</span>
      <p>Interdiction de mise sur le march√© d'IA aux pratiques inacceptables (notation sociale, police pr√©dictive, reconnaissance √©motionnelle au travail, manipulation comportementale). IA √† haut risque (recrutement, cr√©dit, justice) : √©valuation conformit√© obligatoire, supervision humaine. IA g√©n√©rative (GPAI - General Purpose AI) : transparence (watermarking, mention "g√©n√©r√© par IA"), documentation technique, r√©sum√© donn√©es entra√Ænement. Mod√®les √† risque syst√©mique (>10^25 FLOPS) : tests adversaires obligatoires. Sanctions jusqu'√† 35M‚Ç¨ ou 7% CA.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/1689/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/1689 (AI Act)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-iot">
      <div class="header-row">
        <span class="date-badge">12 Sept 2025</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Data Act (Acc√®s IoT)</h2>
      <span class="target-tag">Cible : SaaS IoT, Industrie</span>
      <p>Obligation de fournir aux utilisateurs l'acc√®s aux donn√©es brutes g√©n√©r√©es par leurs objets connect√©s. Droit de partager ces donn√©es avec des tiers (r√©parateurs, services apr√®s-vente). API standardis√©es obligatoires. Interdiction des clauses contractuelles bloquant l'acc√®s aux donn√©es. D√©lai de mise √† disposition : sans retard injustifi√©.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2023/2854/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2023/2854 (Data Act)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">18 Oct 2024</span>
        <span class="origin-badge origin-fr">France (Transpo UE)</span>
      </div>
      <h2>NIS 2 (Cybers√©curit√© Renforc√©e)</h2>
      <span class="target-tag">Cible : SaaS B2B >50 salari√©s, ESN</span>
      <p>Transposition fran√ßaise effective. Obligation d'auto-recensement ANSSI pour entit√©s essentielles (>250 sal. ou >50M‚Ç¨ CA) et importantes (>50 sal.). Notification incidents majeurs sous 24h. Mesures cybers√©curit√© obligatoires : MFA, chiffrement, sauvegardes, gestion correctifs, analyse risques annuelle. Sanctions : jusqu'√† 10M‚Ç¨ ou 2% CA. Responsabilit√© personnelle dirigeants possible.</p>
      <a href="https://eur-lex.europa.eu/eli/dir/2022/2555/oj" target="_blank" class="reg-link">üìÑ Directive (UE) 2022/2555 (NIS 2)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-iot">
      <div class="header-row">
        <span class="date-badge">Juil 2026</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>ESPR (Passeport Num√©rique)</h2>
      <span class="target-tag">Cible : ERP, PLM, Supply Chain</span>
      <p>Mise en place du registre pour le Passeport Num√©rique Produit (DPP). Impact fort sur les logiciels de gestion de production (Textile/Batteries). Tra√ßabilit√© compl√®te obligatoire : composition, r√©parabilit√©, empreinte carbone, recyclabilit√©. QR code ou RFID sur produits. Les logiciels doivent int√©grer capacit√© de g√©n√©ration et stockage DPP.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/1781/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/1781 (ESPR)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">1 Sept 2026</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Facturation √âlectronique (V1)</h2>
      <span class="target-tag">Cible : Logiciels de Gestion / Compta</span>
      <p>Capacit√© de <strong>r√©ception</strong> obligatoire pour toutes les entreprises. <strong>√âmission</strong> obligatoire pour les Grandes Entreprises et ETI. Formats : Factur-X (hybride PDF/XML) ou UBL. Transmission via plateformes de d√©mat√©rialisation partenaires (PDP) ou portail public (PPF). e-Reporting des transactions B2C/export simultan√©. Certification NF 203 recommand√©e.</p>
      <a href="https://www.legifrance.gouv.fr/eli/ordonnance/2024/6/5/2024-640/jo/texte" target="_blank" class="reg-link">üìÑ Ordonnance n¬∞ 2024-640</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">Sept 2026</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Cyber Resilience Act (Reporting)</h2>
      <span class="target-tag">Cible : Tout Editeur Logiciel</span>
      <p>Obligation de signaler les vuln√©rabilit√©s activement exploit√©es √† l'ENISA et au CSIRT national sous 24 heures. Vuln√©rabilit√©s non exploit√©es : notification sous 72h apr√®s d√©couverte. Publication coordonn√©e (CVD) recommand√©e. Base EUDB centralis√©e. Premiers √©diteurs concern√©s : logiciels avec connexion r√©seau ou traitement de donn√©es sensibles.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/2847/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/2847 (CRA)</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">12 Jan 2027</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Data Act (Cloud Switching)</h2>
      <span class="target-tag">Cible : Fournisseurs Cloud / IaaS / PaaS</span>
      <p>Interdiction totale de facturer des frais de sortie (Egress fees) ou de changement de fournisseur. D√©lai maximal de migration : 30 jours (donn√©es) + 30 jours (assistance technique). Export des donn√©es dans format structur√© et machine-readable obligatoire. Clauses contractuelles abusives interdites (p√©nalit√©s dissuasives, verrouillage technique). Concerne IaaS, PaaS, SaaS avec stockage important.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2023/2854/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2023/2854 (Data Act)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-b2b">
      <div class="header-row">
        <span class="date-badge">1 Sept 2027</span>
        <span class="origin-badge origin-fr">France</span>
      </div>
      <h2>Facturation √âlectronique (V2)</h2>
      <span class="target-tag">Cible : Logiciels pour PME/TPE</span>
      <p>G√©n√©ralisation : L'√©mission de factures √©lectroniques structur√©es devient obligatoire pour les PME et TPE. Fin du papier et PDF simple pour B2B. Tous les logiciels de facturation/compta/ERP/CRM doivent int√©grer connexion √† une PDP ou au PPF. Archivage √©lectronique 10 ans obligatoire. Contr√¥les fiscaux automatis√©s accrus (TVA, d√©tection fraude).</p>
      <a href="https://www.legifrance.gouv.fr/eli/ordonnance/2024/6/5/2024-640/jo/texte" target="_blank" class="reg-link">üìÑ Ordonnance n¬∞ 2024-640</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-universal">
      <div class="header-row">
        <span class="date-badge">D√©c 2027</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>Cyber Resilience Act (Total)</h2>
      <span class="target-tag">Cible : Tout Logiciel Commercial</span>
      <p>Marquage CE obligatoire. Security by Design, livraison de SBOM (liste composants) et support de s√©curit√© garanti 5 ans minimum. Produits "critiques" : Classe I (OS, antivirus, VPN, gestionnaires mots de passe) et Classe II (syst√®mes industriels critiques, firewalls) n√©cessitent certification tierce obligatoire. Documentation technique compl√®te : analyse risques, tests s√©curit√©, instructions utilisateurs. Logiciels open-source commercialis√©s inclus. Sanctions : jusqu'√† 15M‚Ç¨ ou 2.5% CA. Exemptions : SaaS pur sans composant t√©l√©charg√©/install√© c√¥t√© client.</p>
      <a href="https://eur-lex.europa.eu/eli/reg/2024/2847/oj" target="_blank" class="reg-link">üìÑ R√®glement (UE) 2024/2847 (CRA)</a>
    </div>
  </div>

  <div class="container right">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">2027 (Est.)</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>DSP3 / PSR (Payment Services Regulation)</h2>
      <span class="target-tag">Cible : Fintech, E-commerce, PSP</span>
      <p>V√©rification obligatoire IBAN/Nom du b√©n√©ficiaire pour tous les virements (lutte fraude). Renforcement APIs Open Banking : acc√®s temps r√©el, dashboards unifi√©s, initiation paiement facilit√©e. Autorisation paiements instantan√©s paneurop√©ens obligatoires. Obligation banques : APIs standardis√©es gratuites. Nouveau r√©gime agr√©ment PSP simplifi√©. SaaS √©trangers avec clients FR concern√©s.</p>
      <a href="https://finance.ec.europa.eu/regulation-and-supervision/financial-services-legislation/implementing-and-delegated-acts/payment-services-directive-psd2_en" target="_blank" class="reg-link">üìÑ PSR - Proposition COM/2023</a>
    </div>
  </div>

  <div class="container left">
    <div class="content card-regulated">
      <div class="header-row">
        <span class="date-badge">2028 (Est.)</span>
        <span class="origin-badge origin-eu">Europe</span>
      </div>
      <h2>EHDS (Espace Europ√©en Donn√©es Sant√©)</h2>
      <span class="target-tag">Cible : Logiciels Sant√© (DPI, Imagerie)</span>
      <p>Obligation d'interop√©rabilit√© europ√©enne pour dossiers patients (r√©sum√© patient, e-prescription) selon format EEHRxF. Acc√®s transfrontalier aux donn√©es sant√© pour soins. Consentement patient centralis√©. Espace europ√©en donn√©es sant√© pour recherche (usage secondaire). Logiciels DPI, imagerie, labo concern√©s. Certification produits sant√© num√©riques renforc√©e. Pilotes nationaux d√®s 2026.</p>
      <a href="https://health.ec.europa.eu/publications/proposal-regulation-european-health-data-space_en" target="_blank" class="reg-link">üìÑ EHDS - Proposition COM/2022</a>
    </div>
  </div>

</div>

<div class="footer">
  <p><strong>Version Q4 2025</strong> - Derni√®re mise √† jour : D√©cembre 2025</p>
  <p>Cette frise synth√©tise les principales r√©glementations europ√©ennes et fran√ßaises applicables aux √©diteurs de logiciels, SaaS, plateformes et prestataires IT.</p>
  <p>‚ö†Ô∏è Document √† vocation informative - Consulter les textes officiels pour application juridique.</p>
  <p style="margin-top: 15px; font-size: 0.8rem;">Sources : EUR-Lex, L√©gifrance, CNIL, ANSSI, Commission Europ√©enne</p>
</div>

<script>
// Calcul de la position du marqueur de date actuelle
document.addEventListener('DOMContentLoaded', function() {
  const today = new Date();
  const containers = document.querySelectorAll('.container');
  
  // Fonction pour parser les dates des badges
  function parseDate(dateText) {
    const months = {
      'Jan': 0, 'F√©v': 1, 'Fev': 1, 'Mars': 2, 'Avr': 3, 'Mai': 4, 'Juin': 5,
      'Juil': 6, 'Ao√ªt': 7, 'Aout': 7, 'Sept': 8, 'Oct': 9, 'Nov': 10, 'D√©c': 11, 'Dec': 11
    };
    
    // Gestion "Fin 2025 (Est.)" -> d√©cembre de l'ann√©e
    if (dateText.match(/Fin\s+(\d{4})/i)) {
      const yearMatch = dateText.match(/(\d{4})/);
      return new Date(parseInt(yearMatch[1]), 11, 31); // 31 d√©cembre
    }
    
    // Gestion des formats: "25 Mai 2018", "1 Jan 2021", "D√©c 2027"
    const match = dateText.match(/(\d+)?\s*([A-Za-z√©√ª]+)\s*(\d{4})/);
    if (match) {
      const day = match[1] ? parseInt(match[1]) : 1;
      const month = months[match[2]] !== undefined ? months[match[2]] : 0;
      const year = parseInt(match[3]);
      return new Date(year, month, day);
    }
    
    // Fallback pour dates approximatives avec ann√©e seule
    const yearMatch = dateText.match(/(\d{4})/);
    if (yearMatch) {
      return new Date(parseInt(yearMatch[1]), 6, 1); // Mi-ann√©e par d√©faut
    }
    
    return null;
  }
  
  // Trouver le conteneur le plus proche de la date actuelle
  let closestContainer = null;
  let closestPast = null;
  let closestFuture = null;
  let minPastDiff = Infinity;
  let minFutureDiff = Infinity;
  
  containers.forEach(container => {
    const dateBadge = container.querySelector('.date-badge');
    if (dateBadge) {
      const eventDate = parseDate(dateBadge.textContent);
      if (eventDate) {
        const diff = eventDate - today;
        
        if (diff <= 0) {
          // √âv√©nement pass√© ou actuel
          const absDiff = Math.abs(diff);
          if (absDiff < minPastDiff) {
            minPastDiff = absDiff;
            closestPast = container;
          }
        } else {
          // √âv√©nement futur
          if (diff < minFutureDiff) {
            minFutureDiff = diff;
            closestFuture = container;
          }
        }
      }
    }
  });
  
  // Prioriser l'√©v√©nement futur le plus proche, sinon prendre le pass√© le plus r√©cent
  closestContainer = closestFuture || closestPast;
  
  // Placer le marqueur et scroller
  let currentMarker = null;
  if (closestContainer) {
    const marker = document.createElement('div');
    marker.className = 'current-date-marker';
    marker.textContent = 'AUJOURD\'HUI';
    marker.style.top = (closestContainer.offsetTop - 50) + 'px';
    marker.id = 'todayMarker';
    
    document.querySelector('.timeline').appendChild(marker);
    currentMarker = marker;
    
    // Scroll automatique vers le marqueur avec un d√©lai pour permettre le rendu
    setTimeout(() => {
      marker.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }, 100);
  }

  // Fonction pour repositionner le marqueur selon les offsets actuels
  function updateMarkerPosition() {
    if (currentMarker && closestContainer) {
      currentMarker.style.top = (closestContainer.offsetTop - 50) + 'px';
    }
  }

  // Bouton retour √† aujourd'hui
  const backToTodayBtn = document.getElementById('backToToday');
  if (backToTodayBtn && currentMarker) {
    backToTodayBtn.addEventListener('click', function() {
      currentMarker.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
  }

  // Recalculer la position du marqueur lors du redimensionnement
  let resizeTimeout;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(function() {
      updateMarkerPosition();
      const tocContainer = document.getElementById('tocContainer');
      if (window.innerWidth > 768) {
        document.body.classList.remove('toc-open');
      } else if (tocContainer && !tocContainer.classList.contains('collapsed')) {
        document.body.classList.add('toc-open');
      }
    }, 100);
  });

  // === SYST√àME DE FILTRAGE ===
  const legendContainer = document.getElementById('legendContainer');
  const legendToggle = document.getElementById('legendToggle');
  const legendItems = document.querySelectorAll('.legend-item');

  // Toggle panneau filtres en mobile
  if (legendToggle) {
    legendToggle.addEventListener('click', function() {
      legendContainer.classList.toggle('expanded');
    });
  }

  // √âtat des filtres (tous actifs par d√©faut)
  const filterState = {
    universal: true,
    b2b: true,
    b2c: true,
    iot: true,
    regulated: true
  };

  // Compter les √©l√©ments par cat√©gorie
  function updateCounts() {
    const counts = {
      universal: 0,
      b2b: 0,
      b2c: 0,
      iot: 0,
      regulated: 0
    };

    containers.forEach(container => {
      const content = container.querySelector('.content');
      if (content.classList.contains('card-universal')) counts.universal++;
      if (content.classList.contains('card-b2b')) counts.b2b++;
      if (content.classList.contains('card-b2c')) counts.b2c++;
      if (content.classList.contains('card-iot')) counts.iot++;
      if (content.classList.contains('card-regulated')) counts.regulated++;
    });

    // Mettre √† jour l'affichage
    Object.keys(counts).forEach(category => {
      const countElement = document.getElementById(`count-${category}`);
      if (countElement) {
        countElement.textContent = counts[category];
      }
    });
  }

  // R√©organiser les conteneurs visibles en quinconce
  function reorderContainers() {
    const visibleContainers = Array.from(containers).filter(c => !c.classList.contains('hidden'));
    
    visibleContainers.forEach((container, index) => {
      // Alterner gauche/droite selon l'index
      if (index % 2 === 0) {
        container.classList.remove('right');
        container.classList.add('left');
      } else {
        container.classList.remove('left');
        container.classList.add('right');
      }
    });
  }

  // Repositionner le marqueur "Aujourd'hui"
  function repositionTodayMarker() {
    if (!currentMarker) return;
    
    // Recalculer la position en fonction des conteneurs visibles
    const visibleContainers = Array.from(containers).filter(c => !c.classList.contains('hidden'));
    if (visibleContainers.length === 0) return;
    
    // Trouver le conteneur visible le plus proche de la date actuelle
    let newClosestPast = null;
    let newClosestFuture = null;
    let minPastDiff = Infinity;
    let minFutureDiff = Infinity;
    
    visibleContainers.forEach(container => {
      const dateBadge = container.querySelector('.date-badge');
      if (dateBadge) {
        const eventDate = parseDate(dateBadge.textContent);
        if (eventDate) {
          const diff = eventDate - today;
          
          if (diff <= 0) {
            // √âv√©nement pass√©
            const absDiff = Math.abs(diff);
            if (absDiff < minPastDiff) {
              minPastDiff = absDiff;
              newClosestPast = container;
            }
          } else {
            // √âv√©nement futur
            if (diff < minFutureDiff) {
              minFutureDiff = diff;
              newClosestFuture = container;
            }
          }
        }
      }
    });
    
    // Prioriser l'√©v√©nement futur le plus proche
    const newClosest = newClosestFuture || newClosestPast;
    if (newClosest) {
      closestContainer = newClosest;
      // Repositionner le marqueur
      currentMarker.style.top = (closestContainer.offsetTop - 50) + 'px';
    }
  }

  // Appliquer les filtres
  function applyFilters() {
    containers.forEach(container => {
      const content = container.querySelector('.content');
      let shouldShow = false;

      // V√©rifier si le conteneur correspond √† au moins une cat√©gorie active
      if (filterState.universal && content.classList.contains('card-universal')) shouldShow = true;
      if (filterState.b2b && content.classList.contains('card-b2b')) shouldShow = true;
      if (filterState.b2c && content.classList.contains('card-b2c')) shouldShow = true;
      if (filterState.iot && content.classList.contains('card-iot')) shouldShow = true;
      if (filterState.regulated && content.classList.contains('card-regulated')) shouldShow = true;

      // Appliquer le masquage
      if (shouldShow) {
        container.classList.remove('hidden');
      } else {
        container.classList.add('hidden');
      }
    });

    // R√©organiser l'alternance apr√®s filtrage
    reorderContainers();
    
    // Repositionner le marqueur "Aujourd'hui"
    repositionTodayMarker();
  }

  // Gestion des clics sur les items de l√©gende (filtres)
  legendItems.forEach(item => {
    const category = item.dataset.category;
    if (!category) return; // Ignorer le titre
    
    item.addEventListener('click', function() {
      filterState[category] = !filterState[category];

      // Mettre √† jour l'apparence de l'item
      if (filterState[category]) {
        this.classList.remove('inactive');
        this.classList.add('active');
      } else {
        this.classList.remove('active');
        this.classList.add('inactive');
      }

      applyFilters();
    });
  });

  // Initialisation
  updateCounts();

  // === SOMMAIRE FLOTTANT ===
  const tocContainer = document.getElementById('tocContainer');
  const tocHeader = document.getElementById('tocHeader');
  const tocContent = document.getElementById('tocContent');

  // G√©n√©rer le sommaire
  function generateTOC() {
    tocContent.innerHTML = '';
    
    containers.forEach((container, index) => {
      // Ignorer les conteneurs masqu√©s
      if (container.classList.contains('hidden')) return;
      
      const dateBadge = container.querySelector('.date-badge');
      const title = container.querySelector('h2');
      
      if (dateBadge && title) {
        const tocItem = document.createElement('a');
        tocItem.className = 'toc-item';
        tocItem.dataset.index = index;
        
        const dateSpan = document.createElement('span');
        dateSpan.className = 'toc-item-date';
        dateSpan.textContent = dateBadge.textContent;
        
        const titleSpan = document.createElement('span');
        titleSpan.className = 'toc-item-title';
        titleSpan.textContent = title.textContent;
        
        tocItem.appendChild(dateSpan);
        tocItem.appendChild(titleSpan);
        
        // Clic pour scroller vers l'√©l√©ment
        tocItem.addEventListener('click', function() {
          container.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
          // Marquer l'√©l√©ment actif
          document.querySelectorAll('.toc-item').forEach(item => item.classList.remove('active'));
          tocItem.classList.add('active');
        });
        
        tocContent.appendChild(tocItem);
      }
    });
  }

  // Toggle du sommaire via l'en-t√™te
  tocHeader.addEventListener('click', function() {
    tocContainer.classList.toggle('collapsed');
    if (window.innerWidth <= 768) {
      document.body.classList.toggle('toc-open', !tocContainer.classList.contains('collapsed'));
    }
  });

  // R√©g√©n√©rer le sommaire initial
  generateTOC();

  // Mettre √† jour le sommaire lors du filtrage
  const originalApplyFilters = applyFilters;
  applyFilters = function() {
    originalApplyFilters();
    generateTOC();
  };
});
</script>

</body>
</html>